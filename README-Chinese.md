# ![image](https://user-images.githubusercontent.com/113756063/203919312-dcec4a61-2136-4af2-a361-66b2ed4e6a54.png) æ•°å­¦è¡¨è¾¾å¼ - ï¼ˆMAEï¼‰è§£æåº“

- Switch to [English Document](https://github.com/BeardedManZhao/mathematical-expression/blob/main/README.md)

## ğŸ«  é‡è¦é€šçŸ¥

> âœ…ã€ä¸€èˆ¬ã€‘ **_PS è¯·å°½é‡ä½¿ç”¨ 1.3.1 ç‰ˆæœ¬ä»¥åŠä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œè¿™å°†æœ‰åŠ©äºæ‚¨ä½¿ç”¨æ›´åŠ ç¨³å®šçš„ç‰ˆæœ¬ï¼Œä¿®å¤äº† 1.2.x
ä¸­[æ‰€æœ‰å·²çŸ¥çš„bug](https://github.com/BeardedManZhao/mathematical-expression/issues)_**

> âš ï¸ã€é‡è¦ã€‘ [1.3.7](https://github.com/BeardedManZhao/mathematical-expression/tree/b8a6dc7a05b8cf2c4b2de57389d520cd03e78ff0)
> ç‰ˆæœ¬å’Œ [1.4.0](https://github.com/BeardedManZhao/mathematical-expression.git) ç‰ˆæœ¬çš„å†…å®¹å‡ ä¹ä¸€è‡´ï¼Œä¸»è¦çš„åŒºåˆ«å°±æ˜¯åŒ…æ¨¡å—çš„å˜æ›´ï¼Œ
**è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å°†åœ¨ 1.4.0 ç‰ˆæœ¬ä»¥åŠä¹‹åçš„æ‰€æœ‰ç‰ˆæœ¬ä¸­
é‡æ„åŒ…åä¸º `io.github.beardedManZhao.mathematicalExpression` è¿™æ˜¯ä¸ºäº†é¿å…åœ¨ Java çš„è¯¸å¤šä¾èµ–ä¸­ï¼ŒåŒ…åå‡ºç°å†²çªçš„æƒ…å†µ~**
>
> ä¸ºäº†é¿å…å°ä¼™ä¼´ä»¬æ‹…å¿ƒç”±äºåŒ…æ›´æ–°å¯¼è‡´çš„å…¼å®¹æ€§é—®é¢˜ï¼Œå› æ­¤æˆ‘ä»¬æä¾›äº† 1.3.7
> ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥ç»§ç»­ä½¿ç”¨æ—§åŒ…åï¼Œä½†æ˜¯æˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨ä½¿ç”¨æ–°ç‰ˆæœ¬ï¼Œå› ä¸ºæ–°ç‰ˆæœ¬çš„åŒ…åå·²ç»æ›´æ–°ä¸º `io.github.beardedManZhao.mathematicalExpression`
> ï¼Œè‹¥æ‚¨å¯¹äºä¿®æ”¹åŒ…åç§°å’Œæ›´æ–°æœ‰ä»€ä¹ˆé—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åŠæ—¶è”ç³»æˆ‘ä»¬ï¼ï¼

## ä»‹ç»

![GitHub Repo stars](https://img.shields.io/github/stars/BeardedManZhao/mathematical-expression)

æœ¬æ¡†æ¶æ˜¯ä¸€ç§é’ˆå¯¹æ•°å­¦å…¬å¼è§£æçš„æœ‰æ•ˆå·¥å…·ï¼Œèƒ½å¤Ÿè§£æåŒ…å«åµŒå¥—å‡½æ•°ï¼ŒåŒ…å«å‡½æ•°ï¼Œæ•°åˆ—æ­¥é•¿ç´¯åŠ ç­‰æ•°å­¦å…¬å¼ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°å€¼çš„ç»“æœå¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è¿›è¡Œæ¯”è¾ƒè¿ç®—çš„æ“ä½œï¼Œå†è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ç»“æœå¯¹è±¡ã€‚

- Mavenä¾èµ–åæ ‡

  æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨mavenå°†æœ¬æ¡†æ¶å¯¼å…¥åˆ°é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œèƒ½å¤Ÿé«˜æ•ˆçš„ä½¿ç”¨è¯¥åŠŸèƒ½

```xml

<dependencies>
    <dependency>
        <groupId>io.github.BeardedManZhao</groupId>
        <artifactId>mathematical-expression</artifactId>
      <version>1.4.4</version>
    </dependency>
</dependencies>
```

æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡gradleå°†â€œmathematical-expressionâ€è½½å…¥åˆ°æ‚¨çš„æ¡†æ¶ä¸­ï¼Œä½¿ç”¨ä¸‹é¢çš„ä¾èµ–å³å¯ã€‚

```
dependencies {
    implementation 'io.github.BeardedManZhao:mathematical-expression:1.4.4'
}
```

### å†å²ç‰ˆæœ¬

æ‚¨å¯ä»¥åœ¨ https://github.com/BeardedManZhao/mathematical-expression/tree/main/update ä¸­æŸ¥è¯¢åˆ°å‘å¸ƒçš„æ‰€æœ‰ç‰ˆæœ¬çš„å˜æ›´è¯¦ç»†æŠ¥å‘Šã€‚

## ä¸ºä»€ä¹ˆè¦é€‰æ‹© mathematical-expression

mathematical-expression å…·æœ‰ç®€å•ï¼Œå¿«é€Ÿï¼Œæ˜“ä¸Šæ‰‹ï¼Œæ”¯æŒçš„è¯­è¨€ç§ç±»å¤š ç­‰ä¼˜åŠ¿ï¼Œå®ƒå…·æœ‰ C Java python ç‰ˆæœ¬çš„ API ä½¿ç”¨æ–¹æ³•å‡ ä¹ä¸€è‡´ã€‚

### æ˜“äºä½¿ç”¨çš„API

è°ƒç”¨åº“æ˜¯å¾ˆç®€å•çš„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œè®¡ç®—ï¼Œå½“ç„¶ï¼Œå¦‚æœæ‚¨ä¸éœ€è¦è¿›è¡Œæ£€æŸ¥ï¼Œæ‚¨è¿˜å¯ä»¥å°†ä¸‹é¢çš„è®¡ç®—ä»£ç å‹ç¼©ä¸º `System.out.println(Mathematical_Expression.getInstance(Mathematical_Expression.bracketsCalculation2).calculation("(1+2)*3"));`
èƒ½å¤Ÿæœ‰æ•ˆå‡å°‘ä»£ç é‡ï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {

  public static void main(String[] args) throws WrongFormat {
    final Calculation instance = Mathematical_Expression.getInstance(
            // åœ¨è¿™é‡Œé€‰æ‹©æ‚¨è¦ä½¿ç”¨çš„ä¸åŒè®¡ç®—ç»„ä»¶å³å¯
            Mathematical_Expression.bracketsCalculation2
    );
    // å¦‚æœæ‚¨ç¡®ä¿è¡¨è¾¾å¼çš„æ— è¯¯ï¼Œå¯ä»¥ä¸æ£€æŸ¥
    instance.check("(1+2)*3");
    System.out.println(instance.calculation("(1+2)*3"));
  }
}
```

### è¶…å¼ºçš„åŠŸèƒ½æ€§ï¼Œæ‹¿æè¯¸å¤šå‡½æ•° å’Œ è®¡ç®—ç¬¦

æ‚¨ä¸ç†Ÿæ‚‰ç¼–ç¨‹ï¼Ÿå¾ˆç®€å•ï¼Œæ‚¨å®Œå…¨å¯ä»¥ä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼è¿›è¡Œå‡½æ•°çš„è‡ªå®šä¹‰ï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜å‡†å¤‡äº†è¯¸å¤šçš„å†…ç½®å‡½æ•°ï¼Œå®ƒä»¬ç»Ÿä¸€åœ¨ `function.calculation.io.github.beardedManZhao.mathematicalExpression.core.FunctionPackage`
ç±»ä¸­ï¼ï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;

import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.FunctionPackage;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

// å‡†å¤‡ä¸€ä¸ªæ•°å­¦å‡½æ•° x çš„é˜¶ä¹˜ + 1
@Functions("f(x) = x! + 1")
public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // æ‚¨å¯ä»¥å°†æˆ‘ä»¬å†…ç½®çš„å‡½æ•°è¿›è¡Œå¯¼å…¥ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨ä¸€äº›å†…ç½®å‡½æ•°äº†ï¼Œå¦‚ sum
    // æ³¨å†Œå†…ç½®çš„å‡½æ•°åº“ - æ•°å­¦åº“
    Mathematical_Expression.register_function(FunctionPackage.MATH);
    // å½“ç„¶ æ‚¨è¿˜å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°çš„æ–¹å¼ å°†æ‚¨è‡ªå·±çš„å‡½æ•° æ³¨å†Œè¿›å»
    Mathematical_Expression.register_function("fTwo(x, y) = x + y");
    // æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£æ‰¹é‡çš„ å°† MAIN æ³¨è§£çš„æ‰€æœ‰å‡½æ•°æ³¨å†Œ å¹¶è¿›è¡Œä½¿ç”¨
    Mathematical_Expression.register_function(MAIN.class);
    // åœ¨ä¸‹é¢å°±å¯ä»¥å¼€å§‹è¿›è¡Œè®¡ç®—äº† é¦–å…ˆæ˜¯è·å–åˆ°è®¡ç®—ç»„ä»¶
    final Calculation instance = Mathematical_Expression.getInstance(Mathematical_Expression.functionFormulaCalculation2);
    // ç„¶åè¿›è¡Œä¸€ä¸ªç®€å•çš„æ£€æŸ¥
    instance.check("1 + sum(1,2,3,4) + f(3) * fTwo(1, 2)");
    // ç„¶åç›´æ¥è¿›è¡Œè®¡ç®— æ‚¨çš„è¡¨è¾¾å¼ä¸­å®Œå…¨æ˜¯å¯ä»¥ä½¿ç”¨å‡½æ•°çš„å“¦~~~
    final CalculationResults calculation = instance.calculation("1 + sum(1,2,3,4) + f(3) * fTwo(1, 2)");
    // ç›´æ¥æ‰“å°å°±å¯ä»¥å•¦~
    System.out.println(calculation);
  }
}
```

è®¡ç®—ç¬¦å·çš„æ”¯æŒä¸å¤Ÿå¤šï¼Ÿä¸ç”¨æ‹…å¿ƒï¼Œæ­¤åº“æ”¯æŒçš„è¿ç®—ç¬¦ç§ç±»ç¹å¤šï¼Œæ‚¨å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æ‰€æœ‰è®¡ç®—ç¬¦.

| ç¬¦å·åç§°   | ç¬¦å·è¯­æ³•ï¼ˆnä»£è¡¨æ“ä½œæ•°ï¼‰ | æ”¯æŒç‰ˆæœ¬  | ç¬¦å·æ„ä¹‰         |
|--------|--------------|-------|--------------|
| åŠ æ³•è¿ç®—ç¬¦  | `n + n`      | 1.0.0 | å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œç›¸åŠ è¿ç®— |
| å‡æ³•æ³•è¿ç®—ç¬¦ | `n - n`      | 1.0.0 | å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œç›¸å‡è¿ç®— |
| ä¹˜æ³•è¿ç®—ç¬¦  | `n * n`      | 1.0.0 | å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œç›¸ä¹˜è¿ç®— |
| é™¤æ³•è¿ç®—ç¬¦  | `n / n`      | 1.0.0 | å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œç›¸é™¤è¿ç®— |
| å–ä½™è¿ç®—ç¬¦  | `n % n`      | 1.0.0 | å°†ä¸¤ä¸ªæ“ä½œæ•°è¿›è¡Œå–ä½™è¿ç®— |
| é˜¶ä¹˜è¿ç®—ç¬¦  | `n!`         | 1.3.2 | å°†æ“ä½œæ•°è¿›è¡Œé˜¶ä¹˜è¿ç®—   |
| å¹‚è¿ç®—ç¬¦   | `n ^ n`      | 1.3.5 | å°†æ“ä½œæ•°è¿›è¡Œå¹‚è¿ç®—    | 

æ‚¨è¿˜å¯ä»¥é€šè¿‡è°ƒæ•´è®¾ç½®å®ç°å¸¦æœ‰ç²¾åº¦çš„è®¡ç®—æ“ä½œä»¥åŠç¼“å­˜æ“ä½œç­‰ï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationResults;

import java.math.BigDecimal;

/**
 * This is the main entry point for the application, demonstrating mathematical expression parsing and evaluation.
 */
public class MAIN {
  public static void main(String[] args) {
    // Obtain an instance of the calculation component, which supports parentheses handling.
    final Calculation calculationInstance = Mathematical_Expression.getInstance(Mathematical_Expression.bracketsCalculation2);
    // Define a sample mathematical expression to evaluate.
    final String inputExpression = "0.3 * 3";
    // Enable caching to improve performance.
    Mathematical_Expression.Options.setUseCache(true);

    // Enable BigDecimal for more accurate results.
    Mathematical_Expression.Options.setUseBigDecimal(true);
    // Evaluate the expression and print the result.
    System.out.println(calculationInstance.calculation(inputExpression));

    // Disable BigDecimal for faster performance.
    Mathematical_Expression.Options.setUseBigDecimal(false);
    // Evaluate the expression and print the result.
    final CalculationResults calculation = calculationInstance.calculation(inputExpression);
    System.out.println(calculation);

    // Can extract different numerical objects
    System.out.println("Can extract different numerical objects!");
    final double result = (double) calculation.getResult();
    final BigDecimal bigDecimalResult = calculation.getBigDecimalResult();
    System.out.println(result);
    System.out.println(bigDecimalResult);
  }
}
```

### ç§ç±»ç¹å¤šåœ°è®¡ç®—ç»„ä»¶

åœ¨mathematical-expression ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†å¤šç§è®¡ç®—ç»„ä»¶ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä¸åŒçš„è®¡ç®—ç»„ä»¶ï¼Œä»¥å®ç°ä¸åŒçš„åŠŸèƒ½ï¼ŒåŒæ—¶è¿˜ä¿æŒç€ç›¸åŒçš„APIè°ƒç”¨æ–¹å¼ã€‚

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

// å‡†å¤‡ä¸€ä¸ªæ•°å­¦å‡½æ•° x çš„é˜¶ä¹˜ + 1
@Functions("f(x) = x! + 1")
public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // å°† MAIN æ³¨è§£çš„å‡½æ•°æ³¨å†Œ å¹¶è¿›è¡Œä½¿ç”¨
    Mathematical_Expression.register_function(MAIN.class);
    final Calculation instance = Mathematical_Expression.getInstance(
            // åœ¨è¿™é‡Œé€‰æ‹©å‡½æ•°è®¡ç®—ç»„ä»¶å³å¯
            Mathematical_Expression.functionFormulaCalculation2
    );
    // å¦‚æœæ‚¨ç¡®ä¿è¡¨è¾¾å¼çš„æ— è¯¯ï¼Œå¯ä»¥ä¸æ£€æŸ¥
    instance.check("f(1 + 2) - 3");
    System.out.println(instance.calculation("f(1 + 2) - 3"));

    /*----------------------------------*/

    // æ‚¨è¿˜å¯ä»¥ç”¨å¿«é€Ÿè®¡ç®—ç»„ä»¶è®¡ç®—åŒºé—´ [1+2, 30] ä¹‹é—´çš„æ±‚å’Œ
    final Calculation instance1 = Mathematical_Expression.getInstance(
            // åœ¨è¿™é‡Œé€‰æ‹©å¿«é€Ÿæ±‚å’Œè®¡ç®—ç»„ä»¶å³å¯ API å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„
            Mathematical_Expression.fastSumOfIntervalsBrackets
    );
    instance1.check("1 + 2, 30");
    System.out.println(instance1.calculation("1 + 2, 30"));
  }
}
```

### è¶…é«˜çš„çµæ´»åº¦

åœ¨å…¶ä¸­çš„ä»»ä½•æ­¥éª¤æ‰€éœ€è¦çš„å‡½æ•°ï¼Œè®¡ç®—å¥½çš„ä»»ä½•å¯¹è±¡ï¼Œéƒ½å¯ä»¥è¢«å•ç‹¬è·å–åˆ°è¿›è¡Œæ‚¨æƒ³è¦çš„æ“ä½œã€‚ä¾‹å¦‚æ•°å­¦å‡½æ•°æ˜¯ä¸€ç§å¤æ‚çš„å¯¹è±¡ï¼Œå…¶ç¼–è¯‘æˆåŠŸä¹‹åï¼Œæ‚¨å¯ä»¥ç›´æ¥è·å–åˆ°å®ƒçš„å‡½æ•°å¯¹è±¡ï¼Œå¹¶ä¸ä»…ä»…å±€é™äºåœ¨
mathematical-expression ä¸­ä½¿ç”¨ï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

// å‡†å¤‡ä¸€ä¸ªæ•°å­¦å‡½æ•° x çš„é˜¶ä¹˜ + 1
@Functions("f(x) = x! + 1")
public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // å°† MAIN æ³¨è§£çš„å‡½æ•°æ³¨å†Œ å¹¶è¿›è¡Œä½¿ç”¨
    Mathematical_Expression.register_function(MAIN.class);
    // æå–å‡º f(x) = x! + 1 çš„å‡½æ•°å¯¹è±¡ æˆ‘ä»¬çŸ¥é“è¿™ä¸ªå‡½æ•°çš„åå­—å°±æ˜¯ f
    final ManyToOneNumberFunction f = Mathematical_Expression.getFunction("f");
    // å•ç‹¬ä½¿ç”¨ f è¿›è¡Œè®¡ç®—
    final double run = f.run(3);
    System.out.println(run);
  }
}
```

### è¯¦ç»†çš„æ‰§è¡Œè®°å½•

æ‚¨åœ¨ä¸€äº›è®¡ç®—ç»„ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ `explain` å‡½æ•°æ¥è¿›è¡Œè¡¨è¾¾å¼çš„è®¡ç®—ï¼Œè¿™ä¸ªå‡½æ•°èƒ½å¤Ÿå°†è®¡ç®—ç»„ä»¶çš„è®¡ç®—è¿‡ç¨‹å®Œæ•´çš„ç»˜åˆ¶æˆä¸ºä¸€ä¸ªæ—¥å¿—ç»“æœå¯¹è±¡ï¼Œæ—¥å¿—ç»“æœå¯¹è±¡å¯ä»¥è¢«ç»˜åˆ¶æˆä¸ºä¸€ä¸ªå›¾ï¼Œä¸‹é¢æ˜¯æ”¯æŒçš„ç»„ä»¶ä»¥åŠä½¿ç”¨ç¤ºä¾‹ã€‚

| è®¡ç®—ç»„ä»¶åç§°                                                                                       | æ˜¯å¦æ”¯æŒ `explain` | ä»ä½•æ—¶å¼€å§‹æ”¯æŒ | ç›¸å…³çŸ¥è¯†                   |
|----------------------------------------------------------------------------------------------|----------------|---------|------------------------|
| io.github.beardedManZhao.mathematicalExpression.core.calculation.PrefixExpressionOperation   | yes            | v1.3.5  | [click this](#æ— æ‹¬å·è¡¨è¾¾å¼)  |
| io.github.beardedManZhao.mathematicalExpression.core.calculation.BracketsCalculation2        | yes            | v1.3.5  | [click this](#åµŒå¥—æ‹¬å·è¡¨è¾¾å¼) |
| io.github.beardedManZhao.mathematicalExpression.core.calculation.CumulativeCalculation       | yes            | v1.3.6  | [click this](#åŒºé—´ç´¯åŠ è¡¨è¾¾å¼) |
| io.github.beardedManZhao.mathematicalExpression.core.calculation.FunctionFormulaCalculation2 | yes            | v1.3.6  | [click this](#å‡½æ•°è¿ç®—è¡¨è¾¾å¼) |

#### å¼•å…¥æµç¨‹å›¾ä»£ç ç”Ÿæˆåº“

æ‚¨åªéœ€è¦å¯¼å…¥ä¸‹é¢çš„ä¾èµ–åæ ‡å°±å¯ä»¥è‡ªåŠ¨å®ç°ç›¸å…³ç»„ä»¶çš„å¯¼å…¥ã€‚è¿™ä¸ªåº“å°†ä¼šå¸®åŠ©æ‚¨å°†è®¡ç®—ç»„ä»¶çš„è®¡ç®—è¿‡ç¨‹ç»˜åˆ¶æˆä¸€ä¸ªæµç¨‹å›¾ã€‚

```xml
<!-- è‹¥æ‚¨çš„ mathematicalExpression ç‰ˆæœ¬å¤§äº 1.4.2 åˆ™ä¸éœ€è¦å¼•å…¥æ­¤ä¾èµ–ï¼ -->
<dependency>
    <groupId>io.github.BeardedManZhao</groupId>
    <artifactId>varFormatter</artifactId>
    <version>1.0.4</version>
</dependency>
```

#### å¼€å§‹è¿›è¡Œç”Ÿæˆ

å¯¼å…¥äº†åº“ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥åƒä¸‹é¢ä¸€æ ·è¿›è¡Œç”Ÿæˆæµç¨‹å›¾ã€‚

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.core.container.LogResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;
import top.lingyuzhao.varFormatter.core.VarFormatter;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // è·å–åˆ°ä¸€ä¸ªæœ‰æ‹¬å·è®¡ç®—ç»„ä»¶ æ‚¨å¯ä»¥æ ¹æ®éœ€æ±‚æ›´æ¢ç»„ä»¶
    final Calculation instance = Mathematical_Expression.getInstance(Mathematical_Expression.bracketsCalculation2);
    // ç„¶åè¿›è¡Œä¸€ä¸ªç®€å•çš„æ£€æŸ¥ è¿™é‡Œæˆ‘ä»¬è¦æŸ¥è¯¢ 1 + 2 ^ 4 - 2 * 3 + 2 çš„æ‰§è¡Œè¿‡ç¨‹
    final String s = "1 + 2 ^ (2 + (10 - 7)) * 3 + 2";
    instance.check(s);
    // æˆ‘ä»¬å¯ä»¥é€šè¿‡ explain è·å–åˆ°æ‰§è¡Œè¿‡ç¨‹ å®ƒä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ è¿™ä¸ªå¯¹è±¡ä¸­æœ‰ä¸€ä¸ª result å­—æ®µ è¿™ä¸ªå­—æ®µå°±æ˜¯è®¡ç®—å‡ºæ¥çš„ç»“æœ
    final LogResults explain = instance.explain(s, true);
    System.out.println("è®¡ç®—ç»“æœï¼š" + explain.getResult());
    // äº‹å®ä¸Š LogResults æ›´å¤§çš„ä½œç”¨æ˜¯è¿›è¡Œæ‰§è¡Œè¿‡ç¨‹å¯è§†åŒ– ä¸‹é¢å°±æ˜¯ä¸€ä¸ªä¾‹å­
    // è®¾ç½®è¾“å‡ºå›¾çš„æ—¶å€™ä¸æ‹¼æ¥åå­—ï¼Œå› ä¸ºåœ¨è¿™é‡Œæœ‰å¾ˆå¤šçš„å˜é‡ éœ€è¦è¿›è¡Œå…³è”çš„ï¼æ‹¼æ¥åå­—å°±ä¸å¥½å…³è”äº†
    explain.setNameJoin(false);
    // é€šè¿‡æˆ‘ä»¬å¼•å…¥çš„ VarFormatter å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œæ ¼å¼åŒ– æˆ‘ä»¬åœ¨è¿™é‡Œæ ¼å¼åŒ–ä¸º MERMAID å›¾ ä»£ç 
    System.out.println("graph LR");
    System.out.println(VarFormatter.MERMAID.getFormatter(true).format(explain));
  }
}
```

ç¨‹åºè¿è¡Œä¹‹åçš„ç»“æœå¦‚ä¸‹æ‰€ç¤º

```
E:\RunTime\jdk8\jdk-8u351\bin\java.exe "-javaagent:D:\Liming\MyApplication\IntelliJ_IDEA\IntelliJ IDEA 2021.3.2\lib\idea_rt.jar=52509:D:\Liming\MyApplication\IntelliJ_IDEA\IntelliJ IDEA 2021.3.2\bin" -Dfile.encoding=UTF-8 -classpath E:\RunTime\jdk8\jdk-8u351\jre\lib\charsets.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\deploy.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\access-bridge-64.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\cldrdata.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\dnsns.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\jaccess.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\jfxrt.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\localedata.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\nashorn.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\sunec.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\sunjce_provider.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\sunmscapi.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\sunpkcs11.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\ext\zipfs.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\javaws.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\jce.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\jfr.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\jfxswt.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\jsse.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\management-agent.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\plugin.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\resources.jar;E:\RunTime\jdk8\jdk-8u351\jre\lib\rt.jar;G:\MyGithub\mathematical-expression\target\test-classes;G:\MyGithub\mathematical-expression\target\classes;G:\RunTime\MAVEN\MAVEN_BASE\org\apache\logging\log4j\log4j-slf4j-impl\2.20.0\log4j-slf4j-impl-2.20.0.jar;G:\RunTime\MAVEN\MAVEN_BASE\org\slf4j\slf4j-api\1.7.25\slf4j-api-1.7.25.jar;G:\RunTime\MAVEN\MAVEN_BASE\org\apache\logging\log4j\log4j-api\2.20.0\log4j-api-2.20.0.jar;G:\RunTime\MAVEN\MAVEN_BASE\org\apache\logging\log4j\log4j-core\2.20.0\log4j-core-2.20.0.jar;G:\RunTime\MAVEN\MAVEN_BASE\io\github\BeardedManZhao\varFormatter\1.0.4\varFormatter-1.0.4.jar MAIN
[INFO][Calculation Management][24-05-13:06]] : +============================== Welcome to [mathematical expression] ==============================+
[INFO][Calculation Management][24-05-13:06]] : + 	Start time Mon May 13 18:20:27 CST 2024
[INFO][Calculation Management][24-05-13:06]] : + 	version: 1.35
[INFO][Calculation Management][24-05-13:06]] : + 	Calculation component manager initialized successfully
[INFO][Calculation Management][24-05-13:06]] : + 	For more information, see: https://github.com/BeardedManZhao/mathematical-expression.git
[INFO][Calculation Management][24-05-13:06]] : +--------------------------------------------------------------------------------------------------+
[INFO][Calculation Management][24-05-13:06]] : A computing component is registered PrefixExpressionOperation
[INFO][Calculation Management][24-05-13:06]] : A computing component is registered bracketsCalculation2
è®¡ç®—ç»“æœï¼š99.0
graph LR
f_-1523352178("1 + 2 ^ (2 + (10 - 7)) * 3 + 2")
f_-1523352178==Map>Map==>f_1563255009
f_1563255009("2 + (10 - 7)")
f_1563255009==Map>Map==>f_1448155011
f_1448155011("10 - 7")
f_1448155011==Map>Map==>f_1507337
f_1507337("10-7+0")
f_1507337==Map>Map==>f_1507337_ä¼˜å…ˆ

f_1507337_ä¼˜å…ˆ==Map>Map==>f_1571371271_è®¡ç®—
f_1571371271("10.0 - 7.0")
f_1571371271_è®¡ç®—==Map>String/Number==>f_1571371271
f_1571371271--Map>value-->f_1571371271v{"3.0"}
f_1571371271_è®¡ç®—==Map>Map==>f_1507337_æœ€ç»ˆ

f_1507337_æœ€ç»ˆ==Map>Map==>f_1481348562_è®¡ç®—
f_1481348562("3.0 + 0.0")
f_1481348562_è®¡ç®—==Map>String/Number==>f_1481348562
f_1481348562--Map>value-->f_1481348562v{"3.0"}
f_1481348562_è®¡ç®—==Map>String/Number==>result
result--Map>value-->resultv{"3.0"}
f_1507337==Map>Map==>f_1507337_æœ€ç»ˆ

f_1507337_æœ€ç»ˆ==Map>Map==>f_1481348562_è®¡ç®—
f_1481348562("3.0 + 0.0")
f_1481348562_è®¡ç®—==Map>String/Number==>f_1481348562
f_1481348562--Map>value-->f_1481348562v{"3.0"}
f_1481348562_è®¡ç®—==Map>String/Number==>result
result--Map>value-->resultv{"3.0"}
f_1563255009==Map>Map==>f_47507548
f_47507548("2+3.0+0")
f_47507548==Map>Map==>f_47507548_ä¼˜å…ˆ

f_47507548_ä¼˜å…ˆ==Map>Map==>f_-1006161388_è®¡ç®—
f_-1006161388("2.0 + 3.0")
f_-1006161388_è®¡ç®—==Map>String/Number==>f_-1006161388
f_-1006161388--Map>value-->f_-1006161388v{"5.0"}
f_-1006161388_è®¡ç®—==Map>Map==>f_47507548_æœ€ç»ˆ

f_47507548_æœ€ç»ˆ==Map>Map==>f_-2133560364_è®¡ç®—
f_-2133560364("5.0 + 0.0")
f_-2133560364_è®¡ç®—==Map>String/Number==>f_-2133560364
f_-2133560364--Map>value-->f_-2133560364v{"5.0"}
f_-2133560364_è®¡ç®—==Map>String/Number==>result
result--Map>value-->resultv{"5.0"}
f_47507548==Map>Map==>f_47507548_æœ€ç»ˆ

f_47507548_æœ€ç»ˆ==Map>Map==>f_-2133560364_è®¡ç®—
f_-2133560364("5.0 + 0.0")
f_-2133560364_è®¡ç®—==Map>String/Number==>f_-2133560364
f_-2133560364--Map>value-->f_-2133560364v{"5.0"}
f_-2133560364_è®¡ç®—==Map>String/Number==>result
result--Map>value-->resultv{"5.0"}
f_-1523352178==Map>Map==>f_-418786079
f_-418786079("1+2^5.0*3+2+0")
f_-418786079==Map>Map==>f_-418786079_ä¼˜å…ˆ

f_-418786079_ä¼˜å…ˆ==Map>Map==>f_-959059895_è®¡ç®—
f_-959059895("2.0 ^ 5.0")
f_-959059895_è®¡ç®—==Map>String/Number==>f_-959059895
f_-959059895--Map>value-->f_-959059895v{"32.0"}
f_-959059895_è®¡ç®—==Map>Map==>f_1855628224_è®¡ç®—
f_1855628224("32.0 * 3.0")
f_1855628224_è®¡ç®—==Map>String/Number==>f_1855628224
f_1855628224--Map>value-->f_1855628224v{"96.0"}
f_1855628224_è®¡ç®—==Map>Map==>f_2037586494_è®¡ç®—
f_2037586494("96.0 + 2.0")
f_2037586494_è®¡ç®—==Map>String/Number==>f_2037586494
f_2037586494--Map>value-->f_2037586494v{"98.0"}
f_2037586494_è®¡ç®—==Map>Map==>f_-418786079_æœ€ç»ˆ

f_-418786079_æœ€ç»ˆ==Map>Map==>f_-929530109_è®¡ç®—
f_-929530109("1.0 + 98.0")
f_-929530109_è®¡ç®—==Map>String/Number==>f_-929530109
f_-929530109--Map>value-->f_-929530109v{"99.0"}
f_-929530109_è®¡ç®—==Map>String/Number==>result
result--Map>value-->resultv{"99.0"}
f_-418786079==Map>Map==>f_-418786079_æœ€ç»ˆ

f_-418786079_æœ€ç»ˆ==Map>Map==>f_-929530109_è®¡ç®—
f_-929530109("1.0 + 98.0")
f_-929530109_è®¡ç®—==Map>String/Number==>f_-929530109
f_-929530109--Map>value-->f_-929530109v{"99.0"}
f_-929530109_è®¡ç®—==Map>String/Number==>result
result--Map>value-->resultv{"99.0"}


è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ä¸º 0

```

ç¨‹åºè¿è¡Œä¹‹åçš„ç»“æœä¸­æœ‰ `mermaid` çš„å›¾ä»£ç ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢å°†å…¶å±•ç¤ºäº†å‡ºæ¥ ä¾›å¤§å®¶è§‚çœ‹ï¼

```mermaid
graph LR
    f_-1523352178("1 + 2 ^ (2 + (10 - 7)) * 3 + 2")
    f_-1523352178 == Map>Map ==> f_1563255009
    f_1563255009("2 + (10 - 7)")
    f_1563255009 == Map>Map ==> f_1448155011
    f_1448155011("10 - 7")
    f_1448155011 == Map>Map ==> f_1507337
    f_1507337("10-7+0")
    f_1507337 == Map>Map ==> f_1507337_ä¼˜å…ˆ
    f_1507337_ä¼˜å…ˆ == Map>Map ==> f_1571371271_è®¡ç®—
    f_1571371271("10.0 - 7.0")
    f_1571371271_è®¡ç®— == Map>String/Number ==> f_1571371271
    f_1571371271 -- Map>value --> f_1571371271v{"3.0"}
    f_1571371271_è®¡ç®— == Map>Map ==> f_1507337_æœ€ç»ˆ
    f_1507337_æœ€ç»ˆ == Map>Map ==> f_1481348562_è®¡ç®—
    f_1481348562("3.0 + 0.0")
    f_1481348562_è®¡ç®— == Map>String/Number ==> f_1481348562
    f_1481348562 -- Map>value --> f_1481348562v{"3.0"}
    f_1481348562_è®¡ç®— == Map>String/Number ==> result
    result -- Map>value --> resultv{"3.0"}
    f_1507337 == Map>Map ==> f_1507337_æœ€ç»ˆ
    f_1507337_æœ€ç»ˆ == Map>Map ==> f_1481348562_è®¡ç®—
    f_1481348562("3.0 + 0.0")
    f_1481348562_è®¡ç®— == Map>String/Number ==> f_1481348562
    f_1481348562 -- Map>value --> f_1481348562v{"3.0"}
    f_1481348562_è®¡ç®— == Map>String/Number ==> result
    result -- Map>value --> resultv{"3.0"}
    f_1563255009 == Map>Map ==> f_47507548
    f_47507548("2+3.0+0")
    f_47507548 == Map>Map ==> f_47507548_ä¼˜å…ˆ
    f_47507548_ä¼˜å…ˆ == Map>Map ==> f_-1006161388_è®¡ç®—
    f_-1006161388("2.0 + 3.0")
    f_-1006161388_è®¡ç®— == Map>String/Number ==> f_-1006161388
    f_-1006161388 -- Map>value --> f_-1006161388v{"5.0"}
    f_-1006161388_è®¡ç®— == Map>Map ==> f_47507548_æœ€ç»ˆ
    f_47507548_æœ€ç»ˆ == Map>Map ==> f_-2133560364_è®¡ç®—
    f_-2133560364("5.0 + 0.0")
    f_-2133560364_è®¡ç®— == Map>String/Number ==> f_-2133560364
    f_-2133560364 -- Map>value --> f_-2133560364v{"5.0"}
    f_-2133560364_è®¡ç®— == Map>String/Number ==> result
    result -- Map>value --> resultv{"5.0"}
    f_47507548 == Map>Map ==> f_47507548_æœ€ç»ˆ
    f_47507548_æœ€ç»ˆ == Map>Map ==> f_-2133560364_è®¡ç®—
    f_-2133560364("5.0 + 0.0")
    f_-2133560364_è®¡ç®— == Map>String/Number ==> f_-2133560364
    f_-2133560364 -- Map>value --> f_-2133560364v{"5.0"}
    f_-2133560364_è®¡ç®— == Map>String/Number ==> result
    result -- Map>value --> resultv{"5.0"}
    f_-1523352178 == Map>Map ==> f_-418786079
    f_-418786079("1+2^5.0*3+2+0")
    f_-418786079 == Map>Map ==> f_-418786079_ä¼˜å…ˆ
    f_-418786079_ä¼˜å…ˆ == Map>Map ==> f_-959059895_è®¡ç®—
    f_-959059895("2.0 ^ 5.0")
    f_-959059895_è®¡ç®— == Map>String/Number ==> f_-959059895
    f_-959059895 -- Map>value --> f_-959059895v{"32.0"}
    f_-959059895_è®¡ç®— == Map>Map ==> f_1855628224_è®¡ç®—
    f_1855628224("32.0 * 3.0")
    f_1855628224_è®¡ç®— == Map>String/Number ==> f_1855628224
    f_1855628224 -- Map>value --> f_1855628224v{"96.0"}
    f_1855628224_è®¡ç®— == Map>Map ==> f_2037586494_è®¡ç®—
    f_2037586494("96.0 + 2.0")
    f_2037586494_è®¡ç®— == Map>String/Number ==> f_2037586494
    f_2037586494 -- Map>value --> f_2037586494v{"98.0"}
    f_2037586494_è®¡ç®— == Map>Map ==> f_-418786079_æœ€ç»ˆ
    f_-418786079_æœ€ç»ˆ == Map>Map ==> f_-929530109_è®¡ç®—
    f_-929530109("1.0 + 98.0")
    f_-929530109_è®¡ç®— == Map>String/Number ==> f_-929530109
    f_-929530109 -- Map>value --> f_-929530109v{"99.0"}
    f_-929530109_è®¡ç®— == Map>String/Number ==> result
    result -- Map>value --> resultv{"99.0"}
    f_-418786079 == Map>Map ==> f_-418786079_æœ€ç»ˆ
    f_-418786079_æœ€ç»ˆ == Map>Map ==> f_-929530109_è®¡ç®—
    f_-929530109("1.0 + 98.0")
    f_-929530109_è®¡ç®— == Map>String/Number ==> f_-929530109
    f_-929530109 -- Map>value --> f_-929530109v{"99.0"}
    f_-929530109_è®¡ç®— == Map>String/Number ==> result
    result -- Map>value --> resultv{"99.0"}
```

## æ¡†æ¶æ¶æ„

### é€šè¿‡ mathematical-expression åº“ç›´æ¥è·å–åˆ°è®¡ç®—ç»„ä»¶å¹¶è¿›è¡Œè®¡ç®—

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // æ„å»ºéœ€è¦è®¡ç®—çš„ä¸¤ç§è¡¨è¾¾å¼
    String s1 = "1 + 20 - 2 + 4", s2 = "1 + 20 - (2 + 4)";
    // é€šè¿‡åº“è·å–åˆ°è®¡ç®—æ— æ‹¬å·è¡¨è¾¾å¼çš„è®¡ç®—ç»„ä»¶
    Calculation prefixExpressionOperation = Mathematical_Expression.getInstance(
            Mathematical_Expression.prefixExpressionOperation, "prefixExpressionOperation"
    );
    // é€šè¿‡åº“è·å–åˆ°è®¡ç®—æœ‰æ‹¬å·è¡¨è¾¾å¼çš„è®¡ç®—ç»„ä»¶
    Calculation bracketsCalculation2 = Mathematical_Expression.getInstance(
            Mathematical_Expression.bracketsCalculation2, "bracketsCalculation2"
    );
    // å°†ç¬¬ä¸€ä¸ªå…¬å¼ä¼ é€’ç»™æ— æ‹¬å·è¡¨è¾¾å¼çš„è®¡ç®—ç»„ä»¶
    prefixExpressionOperation.check(s1);
    CalculationResults calculation1 = prefixExpressionOperation.calculation(s1);
    // æ‰“å°å‡ºç¬¬ä¸€ä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœ
    System.out.println("è®¡ç®—å±‚æ•°ï¼š" + calculation1.getResultLayers() + "\nè®¡ç®—ç»“æœï¼š" + calculation1.getResult() +
            "\nè®¡ç®—æ¥æºï¼š" + calculation1.getCalculationSourceName());


    // å°†ç¬¬äºŒä¸ªå…¬å¼ä¼ é€’ç»™æ— æ‹¬å·è¡¨è¾¾å¼çš„è®¡ç®—ç»„ä»¶
    bracketsCalculation2.check(s2);
    CalculationResults calculation2 = bracketsCalculation2.calculation(s2);
    // æ‰“å°å‡ºç¬¬äºŒä¸ªè¡¨è¾¾å¼çš„è®¡ç®—ç»“æœ
    System.out.println("è®¡ç®—å±‚æ•°ï¼š" + calculation2.getResultLayers() + "\nè®¡ç®—ç»“æœï¼š" + calculation2.getResult() +
            "\nè®¡ç®—æ¥æºï¼š" + calculation2.getCalculationSourceName());
  }
}
```

- è¿è¡Œç»“æœ

  é€šè¿‡å¯¼å…¥åŒ…å¯ä»¥è·å–åˆ°å„ä¸ªè®¡ç®—ç»„ä»¶çš„æ¨¡å—å¯¹è±¡ï¼Œèƒ½å¤Ÿæœ‰æ•ˆçš„å‡å°‘ä»£ç å¯¼åŒ…ä»£ç ã€‚

```
è®¡ç®—å±‚æ•°ï¼š1
è®¡ç®—ç»“æœï¼š23.0
è®¡ç®—æ¥æºï¼šprefixExpressionOperation
è®¡ç®—å±‚æ•°ï¼š2
è®¡ç®—ç»“æœï¼š15.0
è®¡ç®—æ¥æºï¼šbracketsCalculation2
```

### è®¡ç®—ç®¡ç†è€…

- ç±»ç»„ä»¶ï¼šmanager.io.github.beardedManZhao.mathematicalExpression.core.CalculationManagement
- ä»‹ç»ï¼š

  ç®¡ç†è€…æ˜¯ä¸€ä¸ªä¸ºäº†åŒæ—¶ä½¿ç”¨å•ä¾‹ä¸åŠ¨æ€å¯¹è±¡è€Œè®¾è®¡çš„ä¸€ä¸ªç»„ä»¶ï¼Œç®¡ç†è€…çš„å­˜åœ¨å¯ä»¥ä½¿å¾—æ¯ä¸€ä¸ªç»„ä»¶èƒ½å¤Ÿè¢«åå­—æ‰€è·å–åˆ°ï¼Œç›¸åŒåå­—çš„ç»„ä»¶ï¼Œåœ¨å†…å­˜ä¸­çš„å­˜å‚¨åœ°å€ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œé¿å…äº†å†—ä½™ç»„ä»¶çš„è°ƒç”¨ï¼ŒåŒæ—¶é’ˆå¯¹éœ€è¦ä½¿ç”¨åˆ°åŠ¨æ€æˆå‘˜çš„ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸€ä¸ªæ–°åå­—è·å–åˆ°ä¸€ä¸ªæ–°ç»„ä»¶ã€‚
- APIä½¿ç”¨ç¤ºä¾‹

```java
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.FunctionFormulaCalculation;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.PrefixExpressionOperation;
import io.github.beardedManZhao.mathematicalExpression.core.manager.CalculationManagement;

public class MAIN {
  public static void main(String[] args) {
    // å®ä¾‹åŒ–ä¸‰ä¸ªè®¡ç®—ç»„ä»¶
    // TODO getInstanceä¼šè‡ªåŠ¨ä»ç®¡ç†è€…ä¸­è·å–ï¼Œå¦‚æœæ²¡æœ‰è·å–åˆ°ï¼Œå°±ä¼šåˆ›å»ºå¹¶æ³¨å†Œç„¶åå†è¿”å›æ•°æ® è¿™ä¸ªæ–¹æ³•å³å¯ä»¥åˆ›å»ºä¹Ÿå¯ä»¥è®¿é—®ç®¡ç†è€…
    PrefixExpressionOperation a = PrefixExpressionOperation.getInstance("a");
    FunctionFormulaCalculation b = FunctionFormulaCalculation.getInstance("b");
    PrefixExpressionOperation a1 = PrefixExpressionOperation.getInstance("a1");
    // æ³¨å†Œä¸€ä¸ªåä¸ºâ€œaâ€çš„æ— æ‹¬å·è§£æç»„ä»¶
    CalculationManagement.register(a);
    // æ³¨å†Œä¸€ä¸ªåä¸ºâ€œbâ€çš„å‡½æ•°è§£æç»„ä»¶
    CalculationManagement.register(b);
    // æ³¨å†Œä¸€ä¸ªåä¸ºâ€œa1â€çš„æ— æ‹¬å·è§£æç»„ä»¶
    CalculationManagement.register(a1);
    // æ‰“å°æˆ‘ä»¬ç¤ºä¾‹åŒ–çš„ ä¸ ä»ç®¡ç†è€…è·å–åˆ°çš„ç»„ä»¶çš„å†…å­˜æ•°æ®æ˜¯å¦ä¸€è‡´
    System.err.println(a + "  " + CalculationManagement.getCalculationByName("a"));
    System.err.println(b + "  " + CalculationManagement.getCalculationByName("b"));
    System.err.println(a1 + "  " + CalculationManagement.getCalculationByName("a1"));
  }
}
```

- è¿è¡Œç»“æœ

  æœ€åä¸‰è¡Œå°±æ˜¯å†…å­˜æ•°æ®çš„æ¯”è¾ƒï¼Œå®ä¾‹åŒ–å‡ºæ¥çš„ç»„ä»¶ä¸ç®¡ç†è€…ä¸­çš„ç»„ä»¶åœ¨å†…å­˜ä¸­æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯ä¸åŒåç§°çš„ç»„ä»¶æ˜¯ä¸åŒçš„ã€‚

```
[INFO][Calculation Management][22-11-14:11]] : +============================== Welcome to [mathematical expression] ==============================+
[INFO][Calculation Management][22-11-14:11]] : + 	Start time Mon Nov 14 11:45:13 CST 2022
[INFO][Calculation Management][22-11-14:11]] : + 	Calculation component manager initialized successfully
[INFO][Calculation Management][22-11-14:11]] : + 	For more information, see: https://github.com/BeardedManZhao/mathematical-expression.git
[INFO][Calculation Management][22-11-14:11]] : +--------------------------------------------------------------------------------------------------+
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered a
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered PrefixExpressionOperation
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered BracketsCalculation2
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered b
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered a1
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered a
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered b
[INFO][Calculation Management][22-11-14:11]] : A computing component is registered a1
[INFO][Calculation Management][22-11-14:11]] : Get the [a] component from the manager
[INFO][Calculation Management][22-11-14:11]] : Get the [b] component from the manager
[INFO][Calculation Management][22-11-14:11]] : Get the [a1] component from the manager
number.calculation.io.github.beardedManZhao.mathematicalExpression.core.PrefixExpressionOperation@8ad73b  number.calculation.io.github.beardedManZhao.mathematicalExpression.core.PrefixExpressionOperation@8ad73b
number.calculation.io.github.beardedManZhao.mathematicalExpression.core.FunctionFormulaCalculation@762604  number.calculation.io.github.beardedManZhao.mathematicalExpression.core.FunctionFormulaCalculation@762604
number.calculation.io.github.beardedManZhao.mathematicalExpression.core.PrefixExpressionOperation@41e737  number.calculation.io.github.beardedManZhao.mathematicalExpression.core.PrefixExpressionOperation@41e737
```

## è®¡ç®—ç»„ä»¶ä»‹ç»

### æ— æ‹¬å·è¡¨è¾¾å¼

- ç±»ç»„ä»¶ï¼šnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.PrefixExpressionOperation
- ä»‹ç»

  é’ˆå¯¹ä¸€ä¸ªæ²¡æœ‰æ‹¬å·ï¼Œä½†æ˜¯æœ‰åŠ å‡ä¹˜é™¤ä»¥åŠå–ä½™ç­‰è¿ç®—æ“ä½œçš„æ•°å­¦è¡¨è¾¾å¼è€Œè®¾è®¡çš„ç»„ä»¶ï¼Œè¯¥ç»„ä»¶å¯ä»¥å®ç°å¸¦æœ‰ä¼˜å…ˆçº§è®¡ç®—çš„åŠŸèƒ½ï¼Œå…¶ä¸­é€šè¿‡å‰ç¼€è¡¨è¾¾å¼è§£æè®¡ç®—ï¼Œå°†æ“ä½œæ•°ä¸æ“ä½œç¬¦ä¸€åŒå­˜å‚¨åˆ°æ ˆï¼Œåœ¨å­˜å‚¨çš„åŒæ—¶é…æœ‰è®¡ç®—ä¼˜å…ˆçº§æ¯”è¾ƒï¼Œå¦‚æœå½“ä¸‹çš„ä¼˜å…ˆçº§è¾ƒå°ï¼Œå°±å…ˆå°†ä¸Šä¸€ä¸ªæ“ä½œæ•°ä¸æ“ä½œç¬¦ä¸å½“å‰æ“ä½œæ•°è¿›è¡Œè¿ç®—ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„æ•°å€¼ï¼Œç„¶åå†å…¥æ ˆã€‚
- APIä½¿ç”¨ç¤ºä¾‹

  è¯¥ç»„ä»¶æ”¯æŒçš„è¿ç®—ç¬¦æœ‰ï¼š a+b a-b a*b a/b a%b

```java

import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.PrefixExpressionOperation;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationNumberResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // è·å–ä¸€ä¸ªè®¡ç®—æ— æ‹¬å·è¡¨è¾¾å¼çš„å‡½æ•°
    PrefixExpressionOperation prefixExpressionOperation = PrefixExpressionOperation.getInstance("p");
    // åˆ›å»ºä¸€ä¸ªè¡¨è¾¾å¼
    String s = "1 + 2 + 4 * 10 - 3";
    // æ£€æŸ¥è¡¨è¾¾å¼æ˜¯å¦æœ‰é”™è¯¯
    prefixExpressionOperation.check(s);
    // å¼€å§‹è®¡ç®—ç»“æœ
    CalculationNumberResults calculation = prefixExpressionOperation.calculation(s);
    // æ‰“å°ç»“æœæ•°å€¼
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\nè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\nè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ

  åœ¨APIè°ƒç”¨ä¸­ï¼Œå¯¹å‡½æ•°çš„è¿è¡Œç»“æœè¿›è¡Œäº†æ‰“å°ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç»„ä»¶è®¡ç®—çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªç»“æœé›†å¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡ä¸­å­˜å‚¨çš„å°±æ˜¯å¾ˆå¤šæœ‰å…³è®¡ç®—ç»“æœç›¸å…³çš„ä¿¡æ¯ã€‚

```
è®¡ç®—å±‚æ•°ï¼š2
è®¡ç®—ç»“æœï¼š40.0
è®¡ç®—æ¥æºï¼šp
```

### åµŒå¥—æ‹¬å·è¡¨è¾¾å¼

- ç±»ç»„ä»¶ï¼šnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.BracketsCalculation2
- ä»‹ç»ï¼š

  åµŒå¥—æ‹¬å·è¡¨è¾¾å¼è§£æç»„ä»¶ï¼Œèƒ½å¤Ÿé’ˆå¯¹å¸¦æœ‰å¤šä¸ªæ‹¬å·çš„æ•°å­¦è¡¨è¾¾å¼è¿›è¡Œè§£æä¸ç»“æœè®¡ç®—ï¼Œé’ˆå¯¹åµŒå¥—æ‹¬å·è¿›è¡Œä¼˜å…ˆçº§çš„è§£æä¸è®¡ç®—ï¼Œè¯¥ç»„ä»¶ä¾èµ–äºâ€œnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.PrefixExpressionOperationâ€ï¼Œåœ¨è¯¥ç»„ä»¶ä¸­é‡‡ç”¨é€’å½’è¿›è¡Œæ‹¬å·çš„è§£æï¼Œç„¶åå°†æœ€å†…å±‚é¢çš„è¡¨è¾¾å¼æä¾›ç»™â€œnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.PrefixExpressionOperationâ€è¿›è¡Œè®¡ç®—ã€‚
- APIä½¿ç”¨ç¤ºä¾‹

  è¯¥ç»„ä»¶æ”¯æŒçš„è¿ç®—ç¬¦æœ‰ï¼š a+b a-b a*b a/b a%b ( )

```java
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.BracketsCalculation2;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationNumberResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // è·å–ä¸€ä¸ªè®¡ç®—æ— æ‹¬å·è¡¨è¾¾å¼çš„å‡½æ•°
    BracketsCalculation2 bracketsCalculation = BracketsCalculation2.getInstance("BracketsCalculation");
    // åˆ›å»ºä¸€ä¸ªè¡¨è¾¾å¼
    String s = "1 + 2 + 4 * (10 - 3)";
    // æ£€æŸ¥è¡¨è¾¾å¼æ˜¯å¦æœ‰é”™è¯¯
    bracketsCalculation.check(s);
    // å¼€å§‹è®¡ç®—ç»“æœ
    CalculationNumberResults calculation = bracketsCalculation.calculation(s);
    // æ‰“å°ç»“æœæ•°å€¼
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\nè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\nè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ

  åœ¨APIè°ƒç”¨ä¸­ï¼Œå¯¹è¡¨è¾¾å¼çš„è®¡ç®—ç»“æœè¿›è¡Œäº†æ‰“å°ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç»„ä»¶è®¡ç®—çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•°å€¼ç»“æœå¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡ä¸­å­˜å‚¨çš„å°±æ˜¯å¾ˆå¤šæœ‰å…³è®¡ç®—ç»“æœç›¸å…³çš„ä¿¡æ¯ã€‚

```
è®¡ç®—å±‚æ•°ï¼š2
è®¡ç®—ç»“æœï¼š31.0
è®¡ç®—æ¥æºï¼šBracketsCalculation
```

### æ•°å­¦æ¯”è¾ƒè¡¨è¾¾å¼

- ç±»ç»„ä»¶ï¼šbool.calculation.io.github.beardedManZhao.mathematicalExpression.core.BooleanCalculation2
- ä»‹ç»

  ä½¿ç”¨æ¯”è¾ƒè¿ç®—ç¬¦ä¸¤ä¸ªæ‹¬å·è¡¨è¾¾å¼æ˜¯å¦ç›¸äº’æˆç«‹çš„ä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„ç»“æœå¯¹è±¡ï¼Œè¯¥ç»„ä»¶èƒ½å¤Ÿæ¯”è¾ƒä¸¤ä¸ªæ•°å€¼çš„å¤§å°ç­‰ï¼Œä¹Ÿå¯ä»¥æ¯”è¾ƒä¸¤ä¸ªè¡¨è¾¾å¼ä¹‹é—´çš„å¤§å°ç­‰å…³ç³»ï¼Œä¾èµ–äºç»„ä»¶â€œbool.calculation.io.github.beardedManZhao.mathematicalExpression.core.BooleanCalculation2â€
- APIä½¿ç”¨ç¤ºä¾‹

  è¯¥ç»„ä»¶æ”¯æŒçš„è¿ç®—ç¬¦å¦‚APIä¸­æ¼”ç¤º

```java

import io.github.beardedManZhao.mathematicalExpression.core.calculation.bool.BooleanCalculation2;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationBooleanResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // è·å–ä¸€ä¸ªè®¡ç®—æ•°å­¦æ¯”è¾ƒè¡¨è¾¾å¼çš„ç»„ä»¶
    BooleanCalculation2 booleanCalculation2 = BooleanCalculation2.getInstance("Bool");
    // åˆ›å»º3ä¸ªè¡¨è¾¾å¼
    String s1 = "1 + 2 + 4 * (10 - 3)";
    String s2 = "2 + 30 + (2 * 3) - 1";
    String s3 = "1 + 3 * 10";
    extracted(booleanCalculation2, s1 + " > " + s2);// false	
    extracted(booleanCalculation2, s1 + " < " + s2);// true	
    extracted(booleanCalculation2, s1 + " = " + s3);// true	
    extracted(booleanCalculation2, s1 + " == " + s3);// true	
    extracted(booleanCalculation2, s1 + " != " + s3);// false	
    extracted(booleanCalculation2, s1 + " <> " + s3);// false	
    extracted(booleanCalculation2, s1 + " <= " + s3);// true	
    extracted(booleanCalculation2, s1 + " >= " + s3);// true	
    extracted(booleanCalculation2, s1 + " != " + s2);// true	
    extracted(booleanCalculation2, s1 + " <> " + s2);// true	
  }

  private static void extracted(BooleanCalculation2 booleanCalculation2, String s) throws WrongFormat {
    // æ£€æŸ¥è¡¨è¾¾å¼æ˜¯å¦æœ‰é”™è¯¯
    booleanCalculation2.check(s);
    // å¼€å§‹è®¡ç®—ç»“æœ
    CalculationBooleanResults calculation = booleanCalculation2.calculation(s);
    // æ‰“å°ç»“æœæ•°å€¼
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\tè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\tè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ

```
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼šfalse	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼štrue	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼štrue	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼štrue	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼šfalse	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼šfalse	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼štrue	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼štrue	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼štrue	è®¡ç®—æ¥æºï¼šBool
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼štrue	è®¡ç®—æ¥æºï¼šBool
```

### åŒºé—´ç´¯åŠ è¡¨è¾¾å¼

- ç±»ç»„ä»¶ï¼šnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.CumulativeCalculation
- ä»‹ç»

  åœ¨æ•°å­¦è¡¨è¾¾å¼ä¸­ï¼Œå¾€å¾€æœ‰è¿™æ ·çš„ä¸€ç§å…¬å¼ï¼Œå…¬å¼å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°éœ€è¦è¿›è¡Œç´¯åŠ çš„æ•°åˆ—æ“ä½œï¼Œé‚£ä¹ˆåœ¨è¿™ç§å…¬å¼çš„éœ€æ±‚ä¸‹ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¸Šé¢çš„ç±»ç»„ä»¶å»è¾¾åˆ°æ‚¨æ‰€éœ€è¦çš„ç›®çš„ã€‚
  ![img_1](https://user-images.githubusercontent.com/113756063/201575828-5b76af88-6040-430d-a54c-61faf5905594.png)
- APIä½¿ç”¨ç¤ºä¾‹

  è¯­æ³•å±‚é¢äºå…¶ä»–ç»„ä»¶å‡ ä¹ä¸€è‡´ï¼Œæ•°å­¦è¡¨è¾¾å¼çš„æ’°å†™äºç»„ä»¶çš„è®¡ç®—ç¤ºä¾‹å°±å¦‚ä¸‹é¢æ‰€ç¤ºï¼Œåœ¨è¿™é‡Œå±•ç¤ºçš„å°±æ˜¯ä¸€ä¸ªç´¯åŠ æ•°å­¦å…¬å¼çš„è®¡ç®—ã€‚

```java

import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.CumulativeCalculation;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationNumberResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // è·å–ä¸€ä¸ªè®¡ç®—ç´¯åŠ æ•°å­¦è¡¨è¾¾å¼çš„ç»„ä»¶
    CumulativeCalculation cumulativeCalculation = CumulativeCalculation.getInstance("zhao");
    // æ„å»ºä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œè¿™é‡Œçš„"n[1,10,1]"å°±ç±»ä¼¼æ•°å­¦ä¸­çš„ç´¯åŠ ç¬¦å·ï¼Œnä¼šåœ¨è¿™ä¸ªåŒºé—´å†…ä¸æ–­å¢åŠ ï¼Œæ¯å¢åŠ ä¸€æ¬¡éƒ½ä¼šè¢«å¸¦å…¥å…¬å¼ä¸­è®¡ç®—ä¸€æ¬¡
    // å…¶ä¸­[1,10,1]ä¸­çš„æœ€åä¸€ä¸ª1 ä»£è¡¨å¢åŠ æ­¥é•¿ï¼Œèƒ½å¤Ÿå®ç°åŒºé—´å†…ä¸åŒç­‰å·®å€¼çš„ç´¯åŠ 
    String s = "n[1,10,1] 2 * (n + 1)";
    // æ£€æŸ¥æ•°å­¦è¡¨è¾¾å¼
    cumulativeCalculation.check(s);
    // è®¡ç®—ç»“æœ
    CalculationNumberResults calculation = cumulativeCalculation.calculation(s);
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\tè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\tè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ

```
è®¡ç®—å±‚æ•°ï¼š21	è®¡ç®—ç»“æœï¼š130.0	è®¡ç®—æ¥æºï¼šzhao
```

### å‡½æ•°è¿ç®—è¡¨è¾¾å¼

- ç±»ç»„ä»¶ï¼šnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.FunctionFormulaCalculation
- ä»‹ç»

  é’ˆå¯¹ä¸€äº›å‡½æ•°çš„æ“ä½œï¼Œåœ¨è¯¥æ¡†æ¶ä¸­ä¹Ÿæœ‰æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„ç±»è¿›è¡Œè¿™ä¸­éœ€è¦å‡½æ•°çš„æ•°å­¦è¡¨è¾¾å¼çš„ä¹¦å†™ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€åˆ‡åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨åˆ°çš„å‡½æ•°éƒ½éœ€è¦åœ¨â€œCalculationManagementâ€ä¸­è¿›è¡Œé€»è¾‘æ³¨å†Œï¼Œä½¿å¾—è®¡ç®—çš„æ—¶å€™å¯ä»¥è®¿é—®åˆ°å‡½æ•°
- APIä½¿ç”¨ç¤ºä¾‹

```java

import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.FunctionFormulaCalculation;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationNumberResults;
import io.github.beardedManZhao.mathematicalExpression.core.manager.CalculationManagement;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // å®ä¾‹åŒ–ä¸€ä¸ªå‡½æ•° åä¸ºDoubleValue ç”¨äºå°†ä¸€ä¸ªæ•°å€¼ä¹˜2
    ManyToOneNumberFunction myFunction = new ManyToOneNumberFunction("DoubleValue") {
      /**
       * å‡½æ•°çš„è¿è¡Œé€»è¾‘å®ç°
       *
       * @param numbers è¿™é‡Œæ˜¯å‡½æ•°çš„æ•°æ®è¾“å…¥å¯¹è±¡ï¼Œç”±æ¡†æ¶å‘è¿™é‡Œä¼ é€’æ•°æ®è¾“å…¥å‚æ•°
       * @return è¿™é‡Œæ˜¯æ•°æ®ç»è¿‡å‡½æ•°è½¬æ¢ä¹‹åçš„æ•°æ®
       */
      @Override
      public double run(double... numbers) {
        // åœ¨è¿™é‡Œçš„å‚æ•°ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯è¢«FunctionFormulaCalculationæ‰€ä¼ å…¥çš„å‚æ•°
        return numbers[0] * 2;
      }
    };
    // å°†å‡½æ•°æ³¨å†Œåˆ°ç®¡ç†è€…ä¸­
    CalculationManagement.register(myFunction);
    // è·å–ä¸€ä¸ªè®¡ç®—ç´¯åŠ æ•°å­¦è¡¨è¾¾å¼çš„ç»„ä»¶
    FunctionFormulaCalculation functionFormulaCalculation = FunctionFormulaCalculation.getInstance("zhao");
    // æ„å»ºä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼ä¸­ä½¿ç”¨åˆ°äº†å‡½æ•° DoubleValue
    String s = "2 * DoubleValue(2 + 3) + 1";
    // æ£€æŸ¥æ•°å­¦è¡¨è¾¾å¼
    functionFormulaCalculation.check(s);
    // è®¡ç®—ç»“æœ
    CalculationNumberResults calculation = functionFormulaCalculation.calculation(s);
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\tè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\tè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ

```
[INFO][zhao][22-11-14:11]] : Find and prepare the startup function: DoubleValue
è®¡ç®—å±‚æ•°ï¼š1	è®¡ç®—ç»“æœï¼š21.0	è®¡ç®—æ¥æºï¼šBracketsCalculation2
```

### å¤šå‚å‡½æ•°è¿ç®—è¡¨è¾¾å¼

- ç±»ç»„ä»¶ï¼šnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.FunctionFormulaCalculation2
- ä»‹ç»

  é’ˆå¯¹ä¸€äº›åœ¨è¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†å‡½æ•°çš„è¡¨è¾¾å¼è®¡ç®—ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„ç±»è¿›è¡Œæ“ä½œï¼Œå®ƒæ˜¯â€œnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.FunctionFormulaCalculationâ€ç±»çš„å‡çº§ç‰ˆï¼Œä»1.1ç‰ˆæœ¬å¼€å§‹å‡ºç°ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å®ƒçš„ä¸€ä¸ªå­ç±»æ‹“å±•å®ç°ã€‚

  ç›¸è¾ƒäºçˆ¶ç±»ï¼Œæœ¬ç»„ä»¶å¼¥è¡¥äº†çˆ¶ç±»åªèƒ½è§£æå¸¦æœ‰ä¸€ä¸ªå‚æ•°å‡½æ•°è¡¨è¾¾å¼çš„ä¸è¶³ï¼Œåœ¨è¯¥ç»„ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¾ˆå¤šçš„å®å‚è¿›è¡Œå‡½æ•°çš„è¿ç®—ï¼Œä¾‹å¦‚sum(
  1,2,3)
  è¿™ç±»å‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªå¤šå‚å‡½æ•°ï¼Œæ¥ä¸‹æ¥è¯·çœ‹APIçš„ä½¿ç”¨ç¤ºä¾‹ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå±•ç¤ºäº†å¤šæƒ¨å‡½æ•°è¡¨è¾¾å¼çš„è®¡ç®—ä¸ç»“æœã€‚

```java

import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.FunctionFormulaCalculation2;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationNumberResults;
import io.github.beardedManZhao.mathematicalExpression.core.manager.CalculationManagement;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // å®ç°ä¸€ä¸ªsumå‡½æ•°
    ManyToOneNumberFunction manyToOneNumberFunction = new ManyToOneNumberFunction("sum") {
      /**
       * å‡½æ•°çš„è¿è¡Œé€»è¾‘å®ç°
       *
       * @param numbers è¿™é‡Œæ˜¯å‡½æ•°çš„æ•°æ®è¾“å…¥å¯¹è±¡ï¼Œç”±æ¡†æ¶å‘è¿™é‡Œä¼ é€’æ•°æ®è¾“å…¥å‚æ•°
       * @return è¿™é‡Œæ˜¯æ•°æ®ç»è¿‡å‡½æ•°è½¬æ¢ä¹‹åçš„æ•°æ®
       */
      @Override
      public double run(double... numbers) {
        double res = 0;
        for (double number : numbers) {
          res += number;
        }
        return res;
      }
    };
    // å°†è¯¥å‡½æ•°æ³¨å†Œåˆ°ç®¡ç†è€…
    CalculationManagement.register(manyToOneNumberFunction);
    // è·å–åˆ°æ–°ç‰ˆæœ¬çš„å‡½æ•°è®¡ç®—ç»„ä»¶
    FunctionFormulaCalculation2 functionFormulaCalculation2 = FunctionFormulaCalculation2.getInstance("zhao");
    // æ„å»ºæˆ‘ä»¬éœ€è¦è®¡ç®—çš„å…¬å¼ TODO åœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¸­çš„å‡½æ•°sumå½¢å‚ï¼Œä¸åªæœ‰1ä¸ªï¼Œæ˜¯å¤šå‚çš„å‡½æ•°
    String s = "2 * (200 - sum(1 + 10.1, 2, 3)) + sum(10, 20)";
    // å¯ç”¨å…±äº«æ± ï¼Œèƒ½å¤ŸåŠ å¿«è®¡ç®—çš„é€Ÿåº¦ï¼Œè®¡ç®—çš„å…¬å¼è¶Šå¤æ‚ï¼Œè¯¥å…±äº«æ± çš„æ•ˆæœè¶Šæ˜¾è‘—
    functionFormulaCalculation2.setStartSharedPool(true);
    // å¼€å§‹æ£€æŸ¥å…¬å¼æ˜¯å¦æœ‰é”™è¯¯
    functionFormulaCalculation2.check(s);
    // è·å–åˆ°è®¡ç®—ç»“æœ
    CalculationNumberResults calculation = functionFormulaCalculation2.calculation(s);
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\tè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\tè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ

```
è®¡ç®—å±‚æ•°ï¼š2	è®¡ç®—ç»“æœï¼š397.8	è®¡ç®—æ¥æºï¼šBracketsCalculation2
```

#### æ•°å­¦å‡½æ•°è¡¨è¾¾å¼æ³¨å†Œ

æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°çš„æ•°å­¦è¡¨è¾¾å¼æ¥å®ç°æŸä¸ªå‡½æ•°çš„æ³¨å†Œï¼Œå‡½æ•°è¡¨è¾¾å¼çš„æ ¼å¼ä¸º `å‡½æ•°åå­—(å‚æ•°1,å‚æ•°2,å‚æ•°3) = å‡½æ•°é€»è¾‘è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ å‚æ•°1 + å‚æ•°2`
ä¸‹é¢æ˜¯ä¸€ä¸ªæ³¨å†Œç¤ºä¾‹

è¿™æ ·æ³¨å†Œçš„å‡½æ•° ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥åœ¨æ•°å­¦è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„ï¼

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.manager.ConstantRegion;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    System.out.println(ConstantRegion.VERSION);
    // å¼€å§‹è¿›è¡Œæ³¨å†Œ TODO æˆ‘ä»¬åœ¨è¿™é‡Œæ³¨å†Œäº†ä¸€ä¸ªå«åš mySum çš„å‡½æ•° å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•° è¾“å‡ºçš„æ˜¯ä¸¤ä¸ªå‚æ•°çš„æ±‚å’Œç»“æœ
    if (Mathematical_Expression.register_function("mySum(a, b) = a + b")) {
      System.out.println("å‡½æ•°æ³¨å†ŒæˆåŠŸ!");
    }
  }
}
```

### å¿«é€ŸåŒºé—´æ±‚å’Œè®¡ç®—ç»„ä»¶ï¼ˆåŸºäºæ‹¬å·è¡¨è¾¾å¼ï¼‰

- ç±»ç»„ä»¶ï¼šmathematical_expression/core/calculation/number/fastSumOfIntervalsBrackets.py
- ä»‹ç» 1.15ç‰ˆæœ¬çš„æ–°äº§ç‰©ï¼ŒåŒºé—´å¿«é€Ÿæ±‚å’Œç»„ä»¶ï¼Œæ˜¯é’ˆå¯¹ä¸€ä¸ªç­‰å·®ä¸º1çš„åŒºé—´è¿›è¡Œæ‰€æœ‰å…ƒç´ æ±‚å’Œçš„å¿«é€Ÿç»„ä»¶ï¼Œå®ƒå°†ä¸€ä¸ªåŒºé—´åœ¨é€»è¾‘ä¸Šæ¨¡æ‹Ÿæˆä¸ºä¸€ä¸ªæ•°å­¦æ•°åˆ—ï¼Œå¹¶é€šè¿‡æ±‚å’Œå…¬å¼è¿›è¡Œå¿«é€Ÿçš„æ±‚å’Œã€‚

  è¯¥ç»„ä»¶å®ç°äº†å…±äº«æ± è®¡ç®—åŠŸèƒ½ï¼Œå°†æ£€æŸ¥ï¼Œè®¡ç®—ï¼Œä»¥åŠä¸Šä¸€æ¬¡ç»“æœè®°å½•å®ç°ï¼Œèƒ½å¤ŸåŠ å¿«è®¡ç®—é€Ÿåº¦ï¼Œå…·ä½“APIè°ƒç”¨å¦‚ä¸‹æ‰€ç¤ºã€‚

```java

import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.FastSumOfIntervalsBrackets;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationNumberResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // è·å–åˆ°åŒºé—´æ±‚å’Œå¿«è®¡ç®—ç»„ä»¶
    FastSumOfIntervalsBrackets fast = FastSumOfIntervalsBrackets.getInstance("fast");
    // æ„å»ºä¸€ä¸ªéœ€è¦è®¡ç®—çš„è¡¨è¾¾å¼ ä¸‹é¢çš„è¡¨è¾¾å¼ä»£è¡¨ ä» 11 = (1+10) åŠ åˆ° 13 = (20-(5+2)) é»˜è®¤ç­‰å·®ä¸º2 ç»“æœåº”ä¸º 24
    String s = "1 + 10, 20 - (5 + 2)";
    // æ£€æŸ¥è¡¨è¾¾å¼ï¼Œå…±äº«æ± ä»1.2ç‰ˆæœ¬åï¼Œå·²ç»æ˜¯é»˜è®¤å¯ç”¨çš„çŠ¶æ€äº†ï¼ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®äº†
    // fast.setStartSharedPool(true);
    fast.check(s);
    // ä»1.2ç‰ˆæœ¬ä¹‹åï¼Œç´¯åŠ ç»„ä»¶æ”¯æŒè®¾ç½®æ­¥é•¿å‚æ•°ï¼Œ1.2.1ç‰ˆæœ¬ä¸­å¼€å§‹æ­£å¼æ”¯æŒæ­¥é•¿åŒºé—´çš„æ±‚å’Œ
    fast.step = 2;
    // å¼€å§‹è®¡ç®—
    CalculationNumberResults calculation = fast.calculation(s);
    // æ‰“å°è®¡ç®—ç»“æœ
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\tè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\tè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ ä»ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¿«é€ŸåŒºé—´æ±‚å’Œè®¡ç®—çš„å…¬å¼ç”±è¢«é€—å·åˆ†å‰²çš„ä¸¤ä¸ªæ‹¬å·è¡¨è¾¾å¼ç»„æˆ

```
è®¡ç®—å±‚æ•°ï¼š3	è®¡ç®—ç»“æœï¼š24.0	è®¡ç®—æ¥æºï¼šfast
```

### å¿«é€ŸåŒºé—´ç´¯ä¹˜è®¡ç®—ç»„ä»¶ï¼ˆåŸºäºæ‹¬å·è¡¨è¾¾å¼ï¼‰

- ç±»ç»„ä»¶ï¼šnumber.calculation.io.github.beardedManZhao.mathematicalExpression.core.FastMultiplyOfIntervalsBrackets
- ä»‹ç» 1.2ç‰ˆæœ¬çš„æ–°äº§ç‰©ï¼ŒåŒºé—´å¿«é€Ÿç´¯ä¹˜ç»„ä»¶ï¼Œæ˜¯é’ˆå¯¹ä¸€ä¸ªç­‰å·®ä¸ºnçš„åŒºé—´è¿›è¡Œæ‰€æœ‰å…ƒç´ ç´¯ä¹˜çš„å¿«é€Ÿç»„ä»¶ï¼Œå®ƒå°†ä¸€ä¸ªåŒºé—´åœ¨é€»è¾‘ä¸Šæ¨¡æ‹Ÿæˆä¸ºä¸€ä¸ªæ•°å­¦æ•°åˆ—ï¼Œå¹¶é€šè¿‡æ±‚å’Œå…¬å¼è¿›è¡Œå¿«é€Ÿçš„ç´¯ä¹˜ã€‚

  è¯¥ç»„ä»¶å®ç°äº†å…±äº«æ± è®¡ç®—åŠŸèƒ½ï¼Œå°†æ£€æŸ¥ï¼Œè®¡ç®—ï¼Œä»¥åŠä¸Šä¸€æ¬¡ç»“æœè®°å½•å®ç°ï¼Œèƒ½å¤ŸåŠ å¿«è®¡ç®—é€Ÿåº¦ï¼Œå…·ä½“APIè°ƒç”¨å¦‚ä¸‹æ‰€ç¤ºã€‚

```java

import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.FastMultiplyOfIntervalsBrackets;
import io.github.beardedManZhao.mathematicalExpression.core.container.CalculationNumberResults;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

/**
 * æµ‹è¯•ç”¨ç±»
 */
public class MAIN {
  public static void main(String[] args) throws WrongFormat {
    // è·å–åˆ°åŒºé—´æ±‚å’Œå¿«è®¡ç®—ç»„ä»¶
    FastMultiplyOfIntervalsBrackets fast = FastMultiplyOfIntervalsBrackets.getInstance("fast");
    // æ„å»ºä¸€ä¸ªéœ€è¦è®¡ç®—çš„è¡¨è¾¾å¼ ä¸‹é¢çš„è¡¨è¾¾å¼ä»£è¡¨ ä» 11 = (1+10) ä¹˜åˆ° 13 = (20-(5+2)) é»˜è®¤ç­‰å·®ä¸º2
    // ç»“æœåº”ä¸º 11 * 13 = 143
    String s = "1 + 10, 20 - (5 + 2)";
    // æ£€æŸ¥è¡¨è¾¾å¼ï¼Œå…±äº«æ± ä»1.2ç‰ˆæœ¬åï¼Œå·²ç»æ˜¯é»˜è®¤å¯ç”¨çš„çŠ¶æ€äº†ï¼ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®äº†
    // fast.setStartSharedPool(true);
    fast.check(s);
    // ä»1.2ç‰ˆæœ¬ä¹‹åï¼Œç´¯åŠ ç»„ä»¶æ”¯æŒè®¾ç½®æ­¥é•¿å‚æ•°ï¼Œ1.2.1ç‰ˆæœ¬ä¸­å¼€å§‹æ­£å¼æ”¯æŒæ­¥é•¿åŒºé—´çš„æ±‚å’Œ
    fast.step = 2;
    // å¼€å§‹è®¡ç®—
    CalculationNumberResults calculation = fast.calculation(s);
    // æ‰“å°è®¡ç®—ç»“æœ
    System.out.println(
            "è®¡ç®—å±‚æ•°ï¼š" + calculation.getResultLayers() + "\tè®¡ç®—ç»“æœï¼š" + calculation.getResult() +
                    "\tè®¡ç®—æ¥æºï¼š" + calculation.getCalculationSourceName()
    );
  }
}
```

- è¿è¡Œç»“æœ

  ä»ä¸Šé¢ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¿«é€ŸåŒºé—´æ±‚å’Œè®¡ç®—çš„å…¬å¼ç”±è¢«é€—å·åˆ†å‰²çš„ä¸¤ä¸ªæ‹¬å·è¡¨è¾¾å¼ç»„æˆ

```
è®¡ç®—å±‚æ•°ï¼š3	è®¡ç®—ç»“æœï¼š143.0	è®¡ç®—æ¥æºï¼šfast
```

## é«˜é˜¶æ“ä½œ

### æ•°å­¦æ–¹å¼çš„å‡½æ•°æ³¨å†Œä¸è®¡ç®—

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {

  public static void main(String[] args) throws WrongFormat {
    // å°† f å‡½æ•°æ³¨å†Œè¿›æ¥
    Mathematical_Expression.register_function("f(x) = x * x");
    // å‡†å¤‡è¦è®¡ç®—çš„è¡¨è¾¾å¼
    final String data = "1 + f(20) + 3";
    // è·å–åˆ°è®¡ç®—ç»„ä»¶
    final Calculation instance = Mathematical_Expression.getInstance(Mathematical_Expression.functionFormulaCalculation2);
    // æ£€æŸ¥ä¸è®¡ç®—
    instance.check(data);
    System.out.println(instance.calculation(data));
  }
}
```

ä¸‹é¢å°±æ˜¯è®¡ç®—ç»“æœ

```
CalculationNumberResults{result=404.0, source='BracketsCalculation2'}
```

### åŒ¿åå®ç°çš„å‡½æ•°æ³¨å†Œä¸è®¡ç®—

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;

import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

public class MAIN {

  public static void main(String[] args) throws WrongFormat {
    // å°† f å‡½æ•°æ³¨å†Œè¿›æ¥
    Mathematical_Expression.register_function(new ManyToOneNumberFunction("f") {
      @Override
      public double run(double... numbers) {
        return numbers[0] * numbers[0];
      }
    });
    // å‡†å¤‡è¦è®¡ç®—çš„è¡¨è¾¾å¼
    final String data = "1 + f(20) + 3";
    // è·å–åˆ°è®¡ç®—ç»„ä»¶
    final Calculation instance = Mathematical_Expression.getInstance(Mathematical_Expression.functionFormulaCalculation2);
    // æ£€æŸ¥ä¸è®¡ç®—
    instance.check(data);
    System.out.println(instance.calculation(data));
  }
}
```

ä¸‹é¢å°±æ˜¯è®¡ç®—ç»“æœ

```
CalculationNumberResults{result=404.0, source='BracketsCalculation2'}
```

### æ³¨è§£æ–¹å¼å®ç°å‡½æ•°çš„æ³¨å†Œä¸è®¡ç®—

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;

import io.github.beardedManZhao.mathematicalExpression.core.calculation.Calculation;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

@Functions({
        // è¿™é‡Œæ˜¯éœ€è¦è¢«æ³¨å†Œçš„ä¸¤ä¸ªå‡½æ•° åœ¨è¿™é‡Œæ ‡è®°ä¸€ä¸‹
        "f(x) = x * x",
        "ff(x) = f(x) + 1"
})
public class MAIN {

  public static void main(String[] args) throws WrongFormat {
    // å°† MAIN ç±»ä¸­æ ‡è®°çš„æ‰€æœ‰å‡½æ•°æ³¨å†Œ
    if (Mathematical_Expression.register_function(MAIN.class)) {
      // æ„å»ºéœ€è¦è®¡ç®—çš„è¡¨è¾¾å¼
      final String string = "1 + ff(1 + 2) * 2";
      // è·å–åˆ°å‡½æ•°è®¡ç®—ç»„ä»¶
      Calculation calculation = Mathematical_Expression.getInstance(Mathematical_Expression.functionFormulaCalculation2);
      // å¼€å§‹è¿›è¡Œè®¡ç®—
      calculation.check(string);
      System.out.println(calculation.calculation(string));
    }
  }
}
```

ä¸‹é¢å°±æ˜¯è®¡ç®—ç»“æœ

```
CalculationNumberResults{result=21.0, source='functionFormulaCalculation2'}
```

### ç›´æ¥è·å–åˆ°å‡½æ•°å¯¹è±¡ ä»¥åŠ å°†å‡½æ•°å¯¹è±¡ä¿å­˜åˆ°æ–‡ä»¶

æ‰€æœ‰çš„å‡½æ•°å¯¹è±¡éƒ½å¯ä»¥è¢«æå–å‡ºæ¥ï¼Œè€Œé’ˆå¯¹â€œæ•°å­¦å‡½æ•°è¡¨è¾¾å¼â€æ‰€æ³¨å†Œçš„å‡½æ•°æ˜¯å¯ä»¥è¢«ä¿å­˜åˆ°æ–‡ä»¶ä¸­çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›è¡Œåºåˆ—åŒ–çš„æ“ä½œä¿å­˜å®ƒï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†å±•ç¤ºä¸€äº›ç¤ºä¾‹ã€‚

#### æå–å‡ºå‡½æ•°å¯¹è±¡ å•ç‹¬è®¡ç®—

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

@Functions({
        // è¿™é‡Œæ˜¯éœ€è¦è¢«æ³¨å†Œçš„ä¸¤ä¸ªå‡½æ•° åœ¨è¿™é‡Œæ ‡è®°ä¸€ä¸‹ åˆ†åˆ«æ˜¯ f å’Œ ff ä¸¤ä¸ªå‡½æ•°
        "f(x) = x * x",
        "ff(x) = f(x) + 1"
})
public class MAIN {

  public static void main(String[] args) throws WrongFormat {
    // å°† MAIN ç±»ä¸­æ ‡è®°çš„æ‰€æœ‰å‡½æ•°æ³¨å†Œ
    if (Mathematical_Expression.register_function(MAIN.class)) {
      // è·å–åˆ° ff å‡½æ•°
      final ManyToOneNumberFunction ff = Mathematical_Expression.getFunction("ff");
      // è®¡ç®—å‡ºç»“æœ
      final double run = ff.run(1024);
      System.out.println(run);
    }
  }
}
```

ä¸‹é¢å°±æ˜¯è®¡ç®—ç»“æœ

```
1048577.0
```

#### æå–å‡ºå‡½æ•°å¯¹è±¡ ä¿å­˜åˆ°æ–‡ä»¶

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ‚¨è¦ä¿å­˜çš„å‡½æ•°ä¸­ä½¿ç”¨åˆ°äº†å…¶å®ƒå‡½æ•°ï¼Œä¾‹å¦‚ `ff(x) = f(x) + 1`ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦å°† `f(x) = x * x`
ä¹Ÿä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œåœ¨ä¸‹é¢å±•ç¤ºçš„æ˜¯ä¿å­˜ä¸€ä¸ªå‡½æ•°çš„ä»£ç ã€‚

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ExpressionFunction;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

import java.io.*;
import java.nio.file.Files;
import java.nio.file.Paths;

@Functions({
        // è¿™é‡Œæ˜¯éœ€è¦è¢«æ³¨å†Œçš„ä¸¤ä¸ªå‡½æ•° åœ¨è¿™é‡Œæ ‡è®°ä¸€ä¸‹ åˆ†åˆ«æ˜¯ f å’Œ ff ä¸¤ä¸ªå‡½æ•°
        "f(x) = x * x",
        "ff(x) = f(x) + 1"
})
public class MAIN {

  public static void main(String[] args) throws WrongFormat, IOException {
    // å°† MAIN ç±»ä¸­æ ‡è®°çš„æ‰€æœ‰å‡½æ•°æ³¨å†Œ
    if (Mathematical_Expression.register_function(MAIN.class)) {
      // è·å–åˆ° ff å‡½æ•°
      final ManyToOneNumberFunction ff = Mathematical_Expression.getFunction("f");
      // ä¿å­˜åˆ°æ–‡ä»¶ TODO ExpressionFunction çš„å‡½æ•°æ˜¯å¯ä»¥è¢«ä¿å­˜åˆ°æ–‡ä»¶ä¸­çš„
      try (final ObjectOutputStream objectOutput = new ObjectOutputStream(Files.newOutputStream(Paths.get("C:\\Users\\zhao\\Desktop\\fsdownload\\f.me")))) {
        // å°† ff ä¿å­˜åˆ°æ•°æ®æµä¸­
        ((ExpressionFunction) ff).saveTo(objectOutput);
      }
    }
  }
}
```

äº‹å®ä¸Šï¼Œæ‚¨è¿˜å¯ä»¥ä¸€æ¬¡ä¿å­˜å¤šä¸ªå‡½æ•°å¯¹è±¡åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™å°†ä¼šæœ‰åŠ©äºå¸®åŠ©æ‚¨è§£å†³å‡½æ•°ä¾èµ–é—®é¢˜ï¼

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ExpressionFunction;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

import java.io.IOException;
import java.io.ObjectOutputStream;
import java.nio.file.Files;
import java.nio.file.Paths;

@Functions({
        // è¿™é‡Œæ˜¯éœ€è¦è¢«æ³¨å†Œçš„ä¸¤ä¸ªå‡½æ•° åœ¨è¿™é‡Œæ ‡è®°ä¸€ä¸‹ åˆ†åˆ«æ˜¯ f å’Œ ff ä¸¤ä¸ªå‡½æ•°
        "f(x) = x * x",
        "ff(x) = f(x) + 1"
})
public class MAIN {

  public static void main(String[] args) throws WrongFormat, IOException {
    // å°† MAIN ç±»ä¸­æ ‡è®°çš„æ‰€æœ‰å‡½æ•°æ³¨å†Œ
    if (Mathematical_Expression.register_function(MAIN.class)) {
      // è·å–åˆ° ff å‡½æ•° ä»¥åŠ f å‡½æ•°
      final ManyToOneNumberFunction ff = Mathematical_Expression.getFunction("ff");
      final ManyToOneNumberFunction f = Mathematical_Expression.getFunction("f");
      // ä¿å­˜åˆ°æ–‡ä»¶ TODO ExpressionFunction çš„å‡½æ•°æ˜¯å¯ä»¥è¢«ä¿å­˜åˆ°æ–‡ä»¶ä¸­çš„
      try (final ObjectOutputStream objectOutput = new ObjectOutputStream(Files.newOutputStream(Paths.get("C:\\Users\\zhao\\Desktop\\fsdownload\\f.me")))) {
        // å°† ff å’Œ f ä¿å­˜åˆ°æ•°æ®æµä¸­
        ((ExpressionFunction) ff).saveTo(objectOutput);
        ((ExpressionFunction) f).saveTo(objectOutput);
      }
    }
  }
}
```

### å°†æ–‡ä»¶ä¿å­˜çš„å‡½æ•°å¯¹è±¡åŠ è½½åˆ°åº“ä¸­

å‡½æ•°å¯ä»¥è¢«åºåˆ—åŒ–ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥è¢«ååºåˆ—åŒ–ï¼Œååºåˆ—åŒ–ä¹‹åæ‚¨å¯ä»¥å°†å…¶æ³¨å†Œåˆ°åº“ä¸­ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒï¼ï¼ï¼

```java


import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ExpressionFunction;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.nio.file.Files;
import java.nio.file.Paths;

public class MAIN {

  public static void main(String[] args) throws IOException, ClassNotFoundException {
    ManyToOneNumberFunction function;
    try (final ObjectInputStream objectInputStream = new ObjectInputStream(Files.newInputStream(Paths.get("C:\\Users\\zhao\\Desktop\\fsdownload\\f.me")))) {
      // åœ¨è¿™é‡Œè¯»å–åˆ°å‡½æ•°å¯¹è±¡
      function = ExpressionFunction.readFrom(objectInputStream);
    }
    // æŠŠå‡½æ•°æ³¨å†Œå› Mathematical_Expression
    Mathematical_Expression.register_function(function);
    // ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒ
    final double run = function.run(1024);
    System.out.println(run);
  }
}
```

å½“ç„¶ï¼Œååºåˆ—åŒ–ä¹Ÿæ”¯æŒå¤šä¸ªå‡½æ•°å¯¹è±¡çš„åŠ è½½ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹

```java

import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ExpressionFunction;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.nio.file.Files;
import java.nio.file.Paths;

public class MAIN {

  public static void main(String[] args) throws IOException, ClassNotFoundException {
    ManyToOneNumberFunction ff, f;
    try (final ObjectInputStream objectInputStream = new ObjectInputStream(Files.newInputStream(Paths.get("C:\\Users\\zhao\\Desktop\\fsdownload\\f.me")))) {
      // åœ¨è¿™é‡Œè¯»å–åˆ°å‡½æ•°å¯¹è±¡ï¼ˆè¦æ³¨æ„è¿™é‡Œå’Œä¿å­˜æ—¶çš„é¡ºåºä¸€è‡´å“¦ï¼ï¼ï¼‰
      // å¦‚æœè¦æ˜¯ä¸ç¡®å®šé¡ºåºï¼Œå¯ä»¥è¯»å–ç›´æ¥è¯»å–å‡ºæ¥æ³¨å†Œåˆ°åº“é‡Œ åº“ä¼šè‡ªåŠ¨å°†å‡½æ•°çš„åç§°è§£æå‡ºæ¥
      ff = ExpressionFunction.readFrom(objectInputStream);
      f = ExpressionFunction.readFrom(objectInputStream);
    }
    // æŠŠå‡½æ•°æ³¨å†Œå› Mathematical_Expression
    Mathematical_Expression.register_function(ff);
    Mathematical_Expression.register_function(f);
    // ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒ
    final double run = ff.run(1024);
    System.out.println(run);
  }
}
```

### æ‰¹é‡ åºåˆ—åŒ–/æ³¨å†Œ å‡½æ•°

åœ¨ 1.3.4 ç‰ˆæœ¬ä¸­ï¼Œæ‚¨è¿˜å¯ä»¥ç›´æ¥åœ¨ Mathematical_Expression ä¸­ä½¿ç”¨æ•°æ®æµçš„æ–¹å¼æ³¨å†Œ/åºåˆ—åŒ–å‡½æ•°ï¼Œè¿™èƒ½å¤Ÿç®€åŒ–ä»£ç ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼

é¦–å…ˆæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œå°†å‡½æ•°æ³¨å†Œåˆ°åº“ä¸­ï¼ç„¶åä½¿ç”¨ Mathematical_Expression æ¥æ¼”ç¤ºå‡½æ•°çš„åºåˆ—åŒ–æ“ä½œã€‚

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.Functions;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

import java.io.FileOutputStream;
import java.io.IOException;

@Functions({
        // è¿™é‡Œæ˜¯éœ€è¦è¢«æ³¨å†Œçš„ä¸¤ä¸ªå‡½æ•° åœ¨è¿™é‡Œæ ‡è®°ä¸€ä¸‹ åˆ†åˆ«æ˜¯ f å’Œ ff ä»¥åŠ fff å‡ ä¸ªå‡½æ•°
        "f(x) = x * x",
        "ff(x) = f(x) + 1",
        "fff(x) = x! + ff(x) + f(x)"
})
public class MAIN {

  public static void main(String[] args) throws IOException, WrongFormat {
    // å°†å‡½æ•°æ³¨å†Œä¸€ä¸‹
    Mathematical_Expression.register_function(MAIN.class);
    // è·å–åˆ° å‡ ä¸ªå‡½æ•° çš„å¯¹è±¡
    ManyToOneNumberFunction f = Mathematical_Expression.getFunction("f");
    ManyToOneNumberFunction ff = Mathematical_Expression.getFunction("ff");
    ManyToOneNumberFunction fff = Mathematical_Expression.getFunction("fff");
    // ç›´æ¥å°†è¿™å‡ ä¸ªå‡½æ•°è¾“å‡ºåˆ°æ–‡ä»¶ä¸­
    try (final FileOutputStream fileOutputStream = new FileOutputStream("C:\\Users\\zhao\\Desktop\\fsdownload\\f.ME")) {
      Mathematical_Expression.saveFunction(fileOutputStream, f, ff, fff);
    }
  }
}
```

æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰‹åŠ¨å°†æ–‡ä»¶è¯»å–åˆ°å†…å­˜ä¸­å¹¶ä½¿ç”¨ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†æ¼”ç¤º Mathematical_Expression ååºåˆ—åŒ–æ“ä½œï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.function.ManyToOneNumberFunction;
import io.github.beardedManZhao.mathematicalExpression.exceptional.WrongFormat;

import java.io.FileInputStream;
import java.io.IOException;
import java.util.Map;

public class MAIN {

  public static void main(String[] args) throws WrongFormat, IOException {
    // å°†å‡½æ•°æ³¨å†Œä¸€ä¸‹
    try (final FileInputStream fileInputStream = new FileInputStream("C:\\Users\\zhao\\Desktop\\fsdownload\\f.ME")) {
      // ç›´æ¥åœ¨è¿™é‡Œä½¿ç”¨æ•°æ®æµæ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œè¿™ä¸ªæ•°æ®æµå¯¹åº”çš„æ–‡ä»¶åŒ…å«çš„å‡½æ•°éƒ½ä¼šå¼€å§‹å°è¯•æ³¨å†Œ
      final Map.Entry<Integer, Integer> integerIntegerEntry = Mathematical_Expression.register_function(fileInputStream);
      // æ³¨å†Œå®Œæ¯•ä¹‹ååœ¨è¿™é‡Œå°±å¯ä»¥æŸ¥çœ‹åˆ°ç»“æœ
      System.out.println("æ³¨å†ŒæˆåŠŸçš„æ•°é‡ï¼š" + integerIntegerEntry.getKey());
      System.out.println("æ³¨å†Œå¤±è´¥çš„æ•°é‡ï¼š" + integerIntegerEntry.getValue());
    }
    // ç„¶åæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨äº† åœ¨è¿™é‡Œçš„æ•°æ®æµä¸­ åŒ…å«çš„ä¸‰ä¸ªå‡½æ•°åˆ†åˆ«æ˜¯ f ff fff
    final ManyToOneNumberFunction f = Mathematical_Expression.getFunction("f");
    final ManyToOneNumberFunction ff = Mathematical_Expression.getFunction("ff");
    final ManyToOneNumberFunction fff = Mathematical_Expression.getFunction("fff");
    System.out.println(f.run(10));
    System.out.println(ff.run(10));
    System.out.println(fff.run(10));
  }
}
```

ä¸‹é¢æ˜¯è®¡ç®—ç»“æœ

```
[INFO][Calculation Management][24-03-22:01]] : A computing component is registered PrefixExpressionOperation
[INFO][Calculation Management][24-03-22:01]] : A computing component is registered BracketsCalculation2
[INFO][Calculation Management][24-03-22:01]] : A function is registered f
[INFO][Calculation Management][24-03-22:01]] : A function is registered ff
[INFO][Calculation Management][24-03-22:01]] : A function is registered fff
æ³¨å†ŒæˆåŠŸçš„æ•°é‡ï¼š3
æ³¨å†Œå¤±è´¥çš„æ•°é‡ï¼š0
[INFO][Calculation Management][24-03-22:01]] : Get a function component from the manager. => f
[INFO][Calculation Management][24-03-22:01]] : Get a function component from the manager. => ff
[INFO][Calculation Management][24-03-22:01]] : Get a function component from the manager. => fff
[INFO][functionFormulaCalculation_temp][24-03-22:01]] : Use shared pool data. The identity of the data is: functionFormulaCalculation_temp(10.0*10.0)
100.0
[INFO][functionFormulaCalculation_temp][24-03-22:01]] : No Use shared pool: functionFormulaCalculation_temp(f(10.0) + 1)
[INFO][Calculation Management][24-03-22:01]] : Get a function component from the manager. => f
[INFO][functionFormulaCalculation_temp][24-03-22:01]] : Use shared pool data. The identity of the data is: functionFormulaCalculation_temp(10.0*10.0)
101.0
[INFO][functionFormulaCalculation_temp][24-03-22:01]] : No Use shared pool: functionFormulaCalculation_temp(10.0! + ff(10.0) + f(10.0))
[INFO][Calculation Management][24-03-22:01]] : Get a function component from the manager. => f
[INFO][functionFormulaCalculation_temp][24-03-22:01]] : Use shared pool data. The identity of the data is: functionFormulaCalculation_temp(10.0*10.0)
[INFO][Calculation Management][24-03-22:01]] : Get a function component from the manager. => ff
[INFO][functionFormulaCalculation_temp][24-03-22:01]] : Use shared pool data. The identity of the data is: functionFormulaCalculation_temp(f(10.0) + 1)
3629001.0
```

### æ•°å­¦è¡¨è¾¾å¼ç¼–è¯‘

æ•°å­¦è¡¨è¾¾å¼ç¼–è¯‘åŠŸèƒ½ï¼Œå¯ä»¥å°†ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼è½¬æ¢ä¸ºä¸€ä¸ªè¡¨è¾¾å¼å¯¹è±¡ï¼Œæ‰€æœ‰å®ç°äº† `io.github.beardedManZhao.mathematicalExpression.core.calculation.CompileCalculation`
çš„è®¡ç®—ç»„ä»¶éƒ½å¯ä»¥å°†ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼è¿›è¡Œç¼–è¯‘ï¼

è¿™æ ·çš„æ“ä½œå°†å…è®¸ç”¨æˆ·å°†æ•°å­¦è¡¨è¾¾å¼è¿›è¡Œå­˜å‚¨ï¼Œæˆ–æ¨è¿Ÿè®¡ç®—æ—¶æœºç­‰åŠŸèƒ½ï¼Œå¯¹äºéœ€è¦å¤šæ¬¡é‡å¤è®¡ç®—çš„è¡¨è¾¾å¼ï¼Œä½¿ç”¨ç¼–è¯‘åçš„è¡¨è¾¾å¼ï¼Œå¯ä»¥èŠ‚çœå¤§é‡è®¡ç®—æ—¶é—´ï¼

_PS: `io.github.beardedManZhao.mathematicalExpression.core.calculation.CompileCalculation`
çš„æ”¯æŒä¼šéšç€ç‰ˆæœ¬çš„é€’å¢é€æ¸å¢å¤šï¼_

#### åŸºç¡€ä½¿ç”¨ç¤ºä¾‹

> è¿™é‡Œæ¼”ç¤ºçš„æ¡ˆä¾‹ æ˜¯åŸºäº 1.4.2 ç‰ˆæœ¬ï¼Œå› æ­¤æ‚¨éœ€è¦ç¡®ä¿æ‚¨ä½¿ç”¨çš„ç‰ˆæœ¬å¤§äºç­‰äº 1.4.2 æ‰å¯ä»¥ä½¿ç”¨å“¦! åœ¨ 1.4.1 ç‰ˆæœ¬ä¸­çš„ä½¿ç”¨æ–¹å¼å·®ä¸å¤šï¼Œä¸è¿‡ä¸€äº›åŠŸèƒ½ä¸è¢«æ”¯æŒï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.PrefixExpressionOperation;
import io.github.beardedManZhao.mathematicalExpression.core.container.Expression;

public class MAIN {

    public static void main(String[] args) {
        // è·å–åˆ°è®¡ç®—è¡¨è¾¾å¼ç»„ä»¶
        final PrefixExpressionOperation instance = (PrefixExpressionOperation) Mathematical_Expression.getInstance(Mathematical_Expression.prefixExpressionOperation);
        // å°†è¡¨è¾¾å¼ 3*0.3 ç¼–è¯‘ä¸ºä¸€ä¸ªè¡¨è¾¾å¼å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨ 1.4.1 ç‰ˆæœ¬ä¸­æ–°å¢äº†compile & compileBigDecimal æ–¹æ³•ï¼Œä»–ä»¬å¯ä»¥å°†è¡¨è¾¾å¼ç¼–è¯‘ä¸ºå¯¹è±¡ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œä½¿ç”¨ã€‚
        final Expression compile = instance.compile("3 * 0.3", true);
        // è·å–åˆ°è®¡ç®—ç»“æœ åœ¨è¿™é‡Œæœ‰ä¸€ä¸ªå‚æ•°ï¼Œè®¾ç½®ä¸º false æ€§èƒ½ä¼šå¥½äº›ï¼è®¾ç½®ä¸º true åŠŸèƒ½ä¼šå¤šäº›
        System.out.println(compile.calculationCache(true));
        // æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªè¡¨è¾¾å¼é‡å¤çš„è®¡ç®—ï¼Œå¯¹äºè¡¨è¾¾å¼å¯¹è±¡æ¥è¯´ å¤šæ¬¡è°ƒç”¨ calculationCache çš„æ•ˆç‡ä¼šå¾ˆé«˜
        // é™¤äº†ç¬¬ä¸€æ¬¡ calculationCacheï¼Œå…¶ä½™è°ƒç”¨ calculationCache çš„å¤æ‚åº¦çš†ä¸º O(1)
        System.out.println(compile.calculationCache(false));
        // å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç¼–è¯‘å¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€ä¸ª calculationBigDecimalsCache å‡½æ•°
        // å½“æˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™ å¦‚æœæ˜¯ä½¿ç”¨ compile ç¼–è¯‘å‡ºæ¥çš„å°±éœ€è¦ä½¿ç”¨ calculationCache è®¡ç®—
        // å¦‚æœæ˜¯ä½¿ç”¨ compileBigDecimal ç¼–è¯‘å‡ºæ¥çš„å°±éœ€è¦ä½¿ç”¨ calculationBigDecimalsCache è®¡ç®—
        if (compile.isBigDecimal()) {
            // æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ isBigDecimal å‡½æ•°æ¥åˆ¤æ–­å®ƒæ˜¯ä»€ä¹ˆç±»å‹çš„è®¡ç®—æ¨¡å¼
            System.out.println(compile.calculationBigDecimalsCache(false));
        }
    }
}
```

è¿˜å¯ä»¥æ‰‹åŠ¨çš„è°ƒæ•´è®¡ç®—æ¨¡å¼ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.CompileCalculation;
import io.github.beardedManZhao.mathematicalExpression.core.container.Expression;

public class MAIN {

  public static void run(Expression expression) {
    if (expression.isBigDecimal()) {
      // ä»£è¡¨æ”¯æŒé«˜ç²¾åº¦çš„è®¡ç®— TODO è¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸å¸¦ cache çš„è®¡ç®— è¿™æ˜¯ä¸ºäº†æµ‹è¯•æ•ˆæœï¼Œäº‹å®ä¸Š åœ¨æ­¤æ¡ˆä¾‹ä¹‹å¤–ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨ä½¿ç”¨ cache çš„è®¡ç®—ï¼
      System.out.println("é«˜ç²¾åº¦è®¡ç®—ç»“æœï¼š" + expression.calculationBigDecimals(true).getResult());
    }
    if (expression.isUnBigDecimal()) {
      // ä»£è¡¨æ”¯æŒéé«˜ç²¾åº¦çš„è®¡ç®—
      System.out.println("éç²¾åº¦è®¡ç®—ç»“æœï¼š" + expression.calculation(true).getResult());
    }
  }

  public static void main(String[] args) {
    // è·å–åˆ°è®¡ç®—è¡¨è¾¾å¼ç»„ä»¶
    final CompileCalculation instance = (CompileCalculation) Mathematical_Expression.getInstance(Mathematical_Expression.bracketsCalculation2);
    // å°†è¡¨è¾¾å¼ 3*0.3 ç¼–è¯‘ä¸ºä¸€ä¸ªè¡¨è¾¾å¼å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨ 1.4.1 ç‰ˆæœ¬ä¸­æ–°å¢äº†compile & compileBigDecimal æ–¹æ³•ï¼Œä»–ä»¬å¯ä»¥å°†è¡¨è¾¾å¼ç¼–è¯‘ä¸ºå¯¹è±¡ï¼Œæ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œä½¿ç”¨ã€‚
    final Expression compile = instance.compile("1 + (3 * 0.3)", true);
    // è¿è¡Œè¡¨è¾¾å¼ è¿™é‡Œç¬¬ä¸€æ¬¡è®¡ç®—çš„æ—¶å€™ å®ƒå› ä¸º compile çš„ç¼–è¯‘ï¼Œåªæ”¯æŒä½¿ç”¨ éç²¾åº¦è®¡ç®—æ¨¡å¼
    System.out.println("--------");
    run(compile);
    if (compile.isAvailable()) {
      // TODO æ­¤å‡½æ•°éœ€è¦ç¡®ä¿æ‚¨åœ¨ calculationCache or calculationBigDecimalsCache è°ƒç”¨æ—¶æ²¡æœ‰è®¾ç½®ä¸º false
      //  æˆ‘ä»¬å¯ä»¥é€šè¿‡ compile.isAvailable() æ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦æ”¯æŒå¤šç²¾åº¦è®¡ç®—æ¨¡å—çš„å¯ç”¨ å¯ç”¨ä¹‹å æ‚¨å¯ä»¥éšæ„è°ƒç”¨ calculationCache or calculationBigDecimalsCache
      // å°†è¡¨è¾¾å¼çš„å¤šç²¾åº¦æ”¯æŒæ¨¡å¼å¯ç”¨ è¯·æ³¨æ„ æ­¤æ“ä½œä»…å¯ä»¥å¯¹è¡¨è¾¾å¼çš„æœ€åä¸€å±‚è®¡ç®—èµ·ä½œç”¨ï¼
      // ä¾‹å¦‚ 1 + (3*0.3) æœ€åä¸€å±‚å°±æ˜¯ 1 + 0.899999ï¼ˆcompileç¼–è¯‘çš„ï¼‰ æˆ–è€… 1 + 0.9ï¼ˆcompileBigDecimal ç¼–è¯‘çš„ï¼‰
      compile.convertToMultiPrecisionSupported();
      // è¿è¡Œè¡¨è¾¾å¼ TODO è¿™æ ·æ“ä½œä¹‹å æˆ‘ä»¬ä¼šå‘ç°å®ƒå¯ä»¥åœ¨ä¸¤ç§æ¨¡å¼ä¸­è¿›è¡Œè®¡ç®—äº†
      System.out.println("--------");
      run(compile);
        }
    }
}
```

#### åºåˆ—åŒ–ä¸€ä¸ªè¡¨è¾¾å¼å¯¹è±¡

è¡¨è¾¾å¼å¯¹è±¡ç»§æ‰¿äº† `java.io.Serializable` æ¥å£ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥ä½¿ç”¨ `java.io.ObjectOutputStream` å’Œ `java.io.ObjectInputStream`
æ¥åºåˆ—åŒ–ä¸€ä¸ªè¡¨è¾¾å¼å¯¹è±¡ï¼

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.CompileCalculation;
import io.github.beardedManZhao.mathematicalExpression.core.container.NameExpression;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

public class MAIN {
  public static void main(String[] args) throws IOException, ClassNotFoundException {
    // è·å–åˆ°è®¡ç®—ç»„ä»¶
    final CompileCalculation instance = (CompileCalculation) Mathematical_Expression.getInstance(Mathematical_Expression.bracketsCalculation2);
    // å‡†å¤‡ä¸€ä¸ªè·¯å¾„å¯¹è±¡
    final Path path = Paths.get("C:\\Users\\zhao\\Downloads\\è¡¨è¾¾å¼.me");

    // å°†è¡¨è¾¾å¼å¯¹è±¡ä¿å­˜åˆ°ç£ç›˜
    try (final ObjectOutputStream objectOutputStream = new ObjectOutputStream(Files.newOutputStream(path))) {
      // ç¼–è¯‘ä¸€ä¸ªè¡¨è¾¾å¼å¯¹è±¡
      final NameExpression compile = instance.compile(" 1 + (20 * 3 - 3 + (10 -4)) + (30 -2)  /2 + 10", true);
      // å°†è¡¨è¾¾å¼å¯¹è±¡è¾“å‡ºåˆ°ç£ç›˜
      objectOutputStream.writeObject(compile);
    }

    // å†å°†è¡¨è¾¾å¼ä»ç£ç›˜è¯»å–è¿›æ¥
    try (final ObjectInputStream objectInputStream = new ObjectInputStream(Files.newInputStream(path))) {
      // ä»ç£ç›˜ä¸­å°†è¡¨è¾¾å¼é‡æ–°åŠ è½½åˆ°å†…å­˜
      final NameExpression expression = (NameExpression) objectInputStream.readObject();
      // æŸ¥çœ‹è¡¨è¾¾å¼çš„ä¿¡æ¯
      System.out.println("è¡¨è¾¾å¼æ¥æºï¼š" + expression.getCalculationName());
      System.out.println("è¡¨è¾¾å¼çš„æ ¼å¼ï¼š" + expression.getExpressionStr());
      System.out.println("è¡¨è¾¾å¼æ”¯æŒçš„æ¨¡å¼ï¼š" + (expression.isBigDecimal() ? "ã€é«˜ç²¾åº¦ âˆšã€‘ " : "ã€é«˜ç²¾åº¦ Ã—ã€‘ ") + (expression.isUnBigDecimal() ? "ã€éç²¾åº¦ âˆšã€‘ " : "ã€éç²¾åº¦ Ã—ã€‘ "));
      System.out.println(">>> å¼€å§‹ä¸ºè¡¨è¾¾å¼å¯¹è±¡æ·»åŠ å¤šç²¾åº¦æ”¯æŒ");
      expression.convertToMultiPrecisionSupported();
      System.out.println("è¡¨è¾¾å¼æ”¯æŒçš„æ¨¡å¼ï¼š" + (expression.isBigDecimal() ? "ã€é«˜ç²¾åº¦ âˆšã€‘ " : "ã€é«˜ç²¾åº¦ Ã—ã€‘ ") + (expression.isUnBigDecimal() ? "ã€éç²¾åº¦ âˆšã€‘ " : "ã€éç²¾åº¦ Ã—ã€‘ "));
      System.out.println("è®¡ç®—ç»“æœï¼š" + expression.calculation(false));
    }
  }
}
```

<hr>

## Mathematical_Expression.Options æ“ä½œ

æˆ‘ä»¬å…è®¸æ‚¨é€šè¿‡ `Mathematical_Expression.Options` æ¥é…ç½®æ•°å­¦è¡¨è¾¾å¼çš„è®¡ç®—ç»„ä»¶çš„ä¸€äº›æ¨¡å¼ï¼Œé…ç½®çš„é€‰é¡¹ä¼šæ”¹å˜è®¡ç®—ç»„ä»¶çš„è¡Œä¸ºã€‚

### è®¾ç½®ç¼“å­˜è®¡ç®—æ¨¡å¼ setUseCache

ç¼“å­˜è®¡ç®—æ¨¡å¼æ˜¯ä¸€ç§ç‰ºç‰²å†…å­˜ï¼Œä½†æ˜¯æé«˜è®¡ç®—é€Ÿåº¦çš„æ¨¡å¼ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¼“å­˜æ“ä½œå°†ä¼šä¼´éšæ‚¨çš„æ‰€æœ‰å­è¡¨è¾¾å¼ï¼Œè¿™æ„å‘³ç€æ‚¨çš„è¡¨è¾¾å¼å³ä½¿æœ‰æ”¹åŠ¨ï¼Œåªè¦å…¶ä¸­åŒ…å«ä¸€äº›è¢«è®¡ç®—è¿‡çš„è¡¨è¾¾å¼ï¼Œè¿˜æ˜¯å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„ã€‚æ‚¨å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ“ä½œå°†å…¶å¯ç”¨ã€‚

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.CompileCalculation;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.BracketsCalculation2;
import io.github.beardedManZhao.mathematicalExpression.core.container.Expression;

public class MAIN {

  // å‡†å¤‡ä¸€ä¸ªç”¨äºè¿›è¡ŒåŸºå‡†æµ‹è¯•çš„è¡¨è¾¾å¼
  private static String s = "1 + 30 + (20 / 10)";

  static {
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += '+' + s;
    s += "+ 100000";
    System.out.println("æ‚¨è¦è®¡ç®—çš„è¡¨è¾¾å¼ï¼š" + s);
  }

  public static void main(String[] args) {
    // è·å–åˆ°è®¡ç®—è¡¨è¾¾å¼ç»„ä»¶
    final BracketsCalculation2 instance = (BracketsCalculation2) Mathematical_Expression.getInstance(Mathematical_Expression.bracketsCalculation2);
    // é¢„çƒ­
    final Expression compile0 = instance.compileBigDecimal(s, true);
    System.out.println(compile0.calculationBigDecimalsCache(false));
    System.out.println("-------");

    // å¼€å¯ç¼“å­˜æ—¶éå¸¸å¿«ï¼Œèƒ½å¤Ÿæœ‰å¤šå¿«ï¼Œå–å†³äºæ‚¨çš„è¡¨è¾¾å¼ä¸­é‡å¤çš„å­è¡¨è¾¾å¼çš„æ•°é‡ï¼Œæ•°é‡è¶Šå¤š æ•ˆæœè¶Šæ˜æ˜¾
    Mathematical_Expression.Options.setUseCache(true);
    run(instance);
    System.out.println("-------");

    // ä¸å¼€å¯ç¼“å­˜çš„è®¡ç®—é€Ÿåº¦å°±æ…¢äº†è®¸å¤š
    Mathematical_Expression.Options.setUseCache(false);
    run(instance);
  }

  /**
   * åŸºå‡†æµ‹è¯•å‡½æ•°
   *
   * @param instance éœ€è¦ä½¿ç”¨çš„è®¡ç®—ç»„ä»¶
   */
  public static void run(CompileCalculation instance) {
    final long l = System.currentTimeMillis();
    // ç¬¬ä¸€æ¬¡è¿›è¡Œç¼–è¯‘
    final Expression compile = instance.compileBigDecimal(s, true);
    System.out.println(compile.calculationBigDecimalsCache(false));

    final long l1 = System.currentTimeMillis();
    System.out.println("ç¬¬ä¸€æ¬¡è®¡ç®—æ‰€ç”¨æ—¶é—´ï¼š" + (l1 - l));

    // å†ä¸€æ¬¡è¿›è¡Œç¼–è¯‘ ä¸ºäº†ç»“æœä¸¥è°¨ï¼Œè¿™é‡Œå†æ¬¡è®¡ç®— ä¸”ç¬¬äºŒæ¬¡è¡¨è¾¾å¼æœ‰æ‰€æ”¹åŠ¨ æ•´ä½“é™¤2
    final Expression compile1 = instance.compileBigDecimal('(' + s + ") / 2", true);
    System.out.println(compile1.calculationBigDecimalsCache(false));

    System.out.println("ç¬¬äºŒæ¬¡è®¡ç®—æ‰€ç”¨æ—¶é—´ï¼š" + (System.currentTimeMillis() - l1));
  }
}
```

## æ›´å¤šä¿¡æ¯

- Switch to [English Document](https://github.com/BeardedManZhao/mathematical-expression/blob/main/README.md)
- [mathematical-expression-py](https://github.com/BeardedManZhao/mathematical-expression-py.git)
- [mathematical-expression-JS](https://github.com/BeardedManZhao/mathematical-expression-JS.git)
- [mathematical-expression-C++](https://github.com/BeardedManZhao/mathematical-expression-cpp.git)
