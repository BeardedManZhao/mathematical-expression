# 1.4.9 -> 1.5.0 版本更新日志

### 更新时间：2025年03月27日

==Java==

- 更新版本号为 1.5.0
- 重构 底层计算逻辑
    - 针对 长运算操作解析时的错误情况问题 进行了解决（来自小伙伴的提出，感谢他！）
    - 针对 计算操作 的时间复杂度 进行了降低，计算一个编译好的表达式的时间复杂度 在无括号表达式层降低为原来的一半！
        - 因为所有的表达式组件都是依赖 无括号表达式层进行计算，因此整体性能上升！

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.BracketsCalculation2;
import io.github.beardedManZhao.mathematicalExpression.core.container.PackExpression;

public class MAIN {

    public static void main(String[] args) {
        // +0.0000*1
        String formula = "0.0000*1+(0.0000*0.9714+-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+(0.0000-0.0000)*0.0341+1.0000*1.7143+0.0000*1)/10000-0.0000*1+(0.0000*0.9714+-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+(0.0000-0.0000)*0.0341+1.0000*1.7143+0.0000*1)/10000";
        final BracketsCalculation2 instance = (BracketsCalculation2) Mathematical_Expression.getInstance(
                // Select the different computing components you want to use here
                Mathematical_Expression.bracketsCalculation2
        );
        Mathematical_Expression.Options.setUseBigDecimal(false);
        PackExpression packExpression = instance.compileBigDecimal(formula, true);
        System.out.println(packExpression.getExpressionStr());
        System.out.println(packExpression.calculationBigDecimalsCache(false));
    }
}
```

```java
import io.github.beardedManZhao.mathematicalExpression.core.Mathematical_Expression;
import io.github.beardedManZhao.mathematicalExpression.core.calculation.number.BracketsCalculation2;
import io.github.beardedManZhao.mathematicalExpression.core.container.LogResults;
import top.lingyuzhao.varFormatter.core.VarFormatter;

public class MAIN {

    public static void main(String[] args) {
        // +0.0000*1
        String formula = "0.0000*1+(0.0000*0.9714+-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+(0.0000-0.0000)*0.0341+1.0000*1.7143+0.0000*1)/10000-0.0000*1+(0.0000*0.9714+-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+(0.0000-0.0000)*0.0341+1.0000*1.7143+0.0000*1)/10000";
        final BracketsCalculation2 instance = (BracketsCalculation2) Mathematical_Expression.getInstance(
                // Select the different computing components you want to use here
                Mathematical_Expression.bracketsCalculation2
        );
        LogResults explain = instance.explain(formula, true);
        explain.setNameJoin(false);
        String format = VarFormatter.MERMAID.getFormatter(true).format(explain);
        System.out.println(format);
    }
}
```

## 计算图

```mermaid
graph TB

f_-1052364723("0.0000*1+(0.0000*0.9714+-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+(0.0000-0.0000)*0.0341+1.0000*1.7143+0.0000*1)/10000-0.0000*1+(0.0000*0.9714+-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+(0.0000-0.0000)*0.0341+1.0000*1.7143+0.0000*1)/10000")
f_-1052364723==Map>Map==>f_1203094228
f_1203094228("0.0000*0.9714+-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+(0.0000-0.0000)*0.0341+1.0000*1.7143+0.0000*1")
f_1203094228==Map>Map==>f_-1154436947
f_-1154436947("0.0000-0.0000")
f_-1154436947==Map>Map==>f_-1154436947
f_-1154436947("0.0000-0.0000+0")
f_-1154436947==Map>Map==>f_-1154436947_优先

f_-1154436947_优先==Map>Map==>f_-1684375599_计算
f_-1684375599("0.0 - 0.0")
f_-1684375599_计算==Map>String/Number==>f_-1684375599
f_-1684375599--Map>value-->f_-1684375599v{"0.0"}
f_-1684375599_计算==Map>Map==>f_-1154436947_最终

f_-1154436947_最终==Map>Map==>f_-1686222641_计算
f_-1686222641("0.0 + 0.0")
f_-1686222641_计算==Map>String/Number==>f_-1686222641
f_-1686222641--Map>value-->f_-1686222641v{"0.0"}
f_1203094228==Map>Map==>f_389351682
f_389351682("0.0000*0.9714-11.3308*1.229+0.0000*1.4286+0.0008*1.4714+0.0000*1.4714+1.0000*1.4571+0.0000*1.4286+12.7365*13.3+0.0*0.0341+1.0000*1.7143+0.0000*1+0")
f_389351682==Map>Map==>f_389351682_优先

f_389351682_优先==Map>Map==>f_-2063691805_计算
f_-2063691805("0.0 * 0.9714")
f_-2063691805_计算==Map>String/Number==>f_-2063691805
f_-2063691805--Map>value-->f_-2063691805v{"0.0"}
f_-2063691805_计算==Map>Map==>f_-1677870948_计算
f_-1677870948("11.3308 * 1.229")
f_-1677870948_计算==Map>String/Number==>f_-1677870948
f_-1677870948--Map>value-->f_-1677870948v{"13.925553200000001"}
f_-1677870948_计算==Map>Map==>f_-2035216195_计算
f_-2035216195("0.0 * 1.4286")
f_-2035216195_计算==Map>String/Number==>f_-2035216195
f_-2035216195--Map>value-->f_-2035216195v{"0.0"}
f_-2035216195_计算==Map>Map==>f_1525642791_计算
f_1525642791("8.0E-4 * 1.4714")
f_1525642791_计算==Map>String/Number==>f_1525642791
f_1525642791--Map>value-->f_1525642791v{"0.00117712"}
f_1525642791_计算==Map>Map==>f_-2035211609_计算
f_-2035211609("0.0 * 1.4714")
f_-2035211609_计算==Map>String/Number==>f_-2035211609
f_-2035211609--Map>value-->f_-2035211609v{"0.0"}
f_-2035211609_计算==Map>Map==>f_-1906130629_计算
f_-1906130629("1.0 * 1.4571")
f_-1906130629_计算==Map>String/Number==>f_-1906130629
f_-1906130629--Map>value-->f_-1906130629v{"1.4571"}
f_-1906130629_计算==Map>Map==>f_-2035216195_计算
f_-2035216195("0.0 * 1.4286")
f_-2035216195_计算==Map>String/Number==>f_-2035216195
f_-2035216195--Map>value-->f_-2035216195v{"0.0"}
f_-2035216195_计算==Map>Map==>f_-1995102603_计算
f_-1995102603("12.7365 * 13.3")
f_-1995102603_计算==Map>String/Number==>f_-1995102603
f_-1995102603--Map>value-->f_-1995102603v{"169.39545"}
f_-1995102603_计算==Map>Map==>f_-2063963678_计算
f_-2063963678("0.0 * 0.0341")
f_-2063963678_计算==Map>String/Number==>f_-2063963678
f_-2063963678--Map>value-->f_-2063963678v{"0.0"}
f_-2063963678_计算==Map>Map==>f_-1906045191_计算
f_-1906045191("1.0 * 1.7143")
f_-1906045191_计算==Map>String/Number==>f_-1906045191
f_-1906045191--Map>value-->f_-1906045191v{"1.7143"}
f_-1906045191_计算==Map>Map==>f_-1687145201_计算
f_-1687145201("0.0 * 1.0")
f_-1687145201_计算==Map>String/Number==>f_-1687145201
f_-1687145201--Map>value-->f_-1687145201v{"0.0"}
f_-1687145201_计算==Map>Map==>f_389351682_最终

f_389351682_最终==Map>Map==>f_1301362865_计算
f_1301362865("0.0 - 13.925553200000001")
f_1301362865_计算==Map>String/Number==>f_1301362865
f_1301362865--Map>value-->f_1301362865v{"-13.925553200000001"}
f_1301362865_计算==Map>Map==>f_-886042118_计算
f_-886042118("-13.925553200000001 + 0.0")
f_-886042118_计算==Map>String/Number==>f_-886042118
f_-886042118--Map>value-->f_-886042118v{"-13.925553200000001"}
f_-886042118_计算==Map>Map==>f_-431650793_计算
f_-431650793("-13.925553200000001 + 0.00117712")
f_-431650793_计算==Map>String/Number==>f_-431650793
f_-431650793--Map>value-->f_-431650793v{"-13.924376080000002"}
f_-431650793_计算==Map>Map==>f_1250489681_计算
f_1250489681("-13.924376080000002 + 0.0")
f_1250489681_计算==Map>String/Number==>f_1250489681
f_1250489681--Map>value-->f_1250489681v{"-13.924376080000002"}
f_1250489681_计算==Map>Map==>f_-1179437831_计算
f_-1179437831("-13.924376080000002 + 1.4571")
f_-1179437831_计算==Map>String/Number==>f_-1179437831
f_-1179437831--Map>value-->f_-1179437831v{"-12.467276080000001"}
f_-1179437831_计算==Map>Map==>f_-815205910_计算
f_-815205910("-12.467276080000001 + 0.0")
f_-815205910_计算==Map>String/Number==>f_-815205910
f_-815205910--Map>value-->f_-815205910v{"-12.467276080000001"}
f_-815205910_计算==Map>Map==>f_-1167026290_计算
f_-1167026290("-12.467276080000001 + 169.39545")
f_-1167026290_计算==Map>String/Number==>f_-1167026290
f_-1167026290--Map>value-->f_-1167026290v{"156.92817392"}
f_-1167026290_计算==Map>Map==>f_-797902912_计算
f_-797902912("156.92817392 + 0.0")
f_-797902912_计算==Map>String/Number==>f_-797902912
f_-797902912--Map>value-->f_-797902912v{"156.92817392"}
f_-797902912_计算==Map>Map==>f_-1947748888_计算
f_-1947748888("156.92817392 + 1.7143")
f_-1947748888_计算==Map>String/Number==>f_-1947748888
f_-1947748888--Map>value-->f_-1947748888v{"158.64247392000001"}
f_-1947748888_计算==Map>Map==>f_-1171328595_计算
f_-1171328595("158.64247392000001 + 0.0")
f_-1171328595_计算==Map>String/Number==>f_-1171328595
f_-1171328595--Map>value-->f_-1171328595v{"158.64247392000001"}
f_-1171328595_计算==Map>Map==>f_-1171328595_计算
f_-1171328595("158.64247392000001 + 0.0")
f_-1171328595_计算==Map>String/Number==>f_-1171328595
f_-1171328595--Map>value-->f_-1171328595v{"158.64247392000001"}
f_-1052364723==Map>Map==>f_675144675
f_675144675("0.0000*1+158.64247392000001/10000-0.0000*1+158.64247392000001/10000+0")
f_675144675==Map>Map==>f_675144675_优先

f_675144675_优先==Map>Map==>f_-1687145201_计算
f_-1687145201("0.0 * 1.0")
f_-1687145201_计算==Map>String/Number==>f_-1687145201
f_-1687145201--Map>value-->f_-1687145201v{"0.0"}
f_-1687145201_计算==Map>Map==>f_-900954254_计算
f_-900954254("158.64247392000001 / 10000.0")
f_-900954254_计算==Map>String/Number==>f_-900954254
f_-900954254--Map>value-->f_-900954254v{"0.015864247392"}
f_-900954254_计算==Map>Map==>f_-1687145201_计算
f_-1687145201("0.0 * 1.0")
f_-1687145201_计算==Map>String/Number==>f_-1687145201
f_-1687145201--Map>value-->f_-1687145201v{"0.0"}
f_-1687145201_计算==Map>Map==>f_-900954254_计算
f_-900954254("158.64247392000001 / 10000.0")
f_-900954254_计算==Map>String/Number==>f_-900954254
f_-900954254--Map>value-->f_-900954254v{"0.015864247392"}
f_-900954254_计算==Map>Map==>f_675144675_最终

f_675144675_最终==Map>Map==>f_-1687636262_计算
f_-1687636262("0.0 + 0.015864247392")
f_-1687636262_计算==Map>String/Number==>f_-1687636262
f_-1687636262--Map>value-->f_-1687636262v{"0.015864247392"}
f_-1687636262_计算==Map>Map==>f_-1791311882_计算
f_-1791311882("0.015864247392 - 0.0")
f_-1791311882_计算==Map>String/Number==>f_-1791311882
f_-1791311882--Map>value-->f_-1791311882v{"0.015864247392"}
f_-1791311882_计算==Map>Map==>f_1895323029_计算
f_1895323029("0.015864247392 + 0.015864247392")
f_1895323029_计算==Map>String/Number==>f_1895323029
f_1895323029--Map>value-->f_1895323029v{"0.031728494784"}
f_1895323029_计算==Map>Map==>f_-153101938_计算
f_-153101938("0.031728494784 + 0.0")
f_-153101938_计算==Map>String/Number==>f_-153101938
f_-153101938--Map>value-->f_-153101938v{"0.031728494784"}
f_-153101938_计算==Map>String/Number==>result
result--Map>value-->resultv{"0.031728494784"}
```